<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูู ุฃุจูุน ุณูููุ โ ูููุฑุฉ ูุณุชุซูุฑ</title>
    <link rel="stylesheet" href="navigation.css">
    <link rel="stylesheet" href="dark-theme.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Arial, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh; padding: 20px; color: #f0f4f8;
        }

        .container { max-width: 780px; margin: 0 auto; }

        .page-header { text-align: center; margin-bottom: 30px; }
        .page-header h1 {
            font-size: 2.2rem; color: #ffffff; font-weight: bold;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
        }
        .page-header p {
            font-size: 0.95rem; color: #d0e1f9; margin-top: 8px; line-height: 1.6;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
        }

        /* ===== Glassmorphism Card ===== */
        .advisor-card {
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1.5px solid rgba(255,255,255,0.15);
            border-radius: 24px; padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.1);
            margin-bottom: 20px; position: relative; overflow: hidden;
        }
        .advisor-card::before {
            content: ''; position: absolute; top: 0; right: 0; left: 0; height: 5px;
            background: linear-gradient(90deg, #f39c12, #e74c3c, #c0392b);
        }

        .progress-bar-wrap {
            background: rgba(255,255,255,0.08); border-radius: 10px;
            height: 8px; margin-bottom: 20px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .progress-bar-fill {
            height: 100%; background: linear-gradient(90deg, #5a7fb5, #5a9d7a);
            border-radius: 10px; transition: width 0.4s ease; width: 0%;
        }
        .progress-label {
            font-size: 0.78rem; color: #d0e1f9; text-align: left;
            margin-bottom: 6px; direction: ltr; font-weight: 500;
        }

        .question-number {
            font-size: 0.8rem; color: #ffa726; font-weight: bold;
            margin-bottom: 6px; letter-spacing: 0.5px;
        }
        .question-text {
            font-size: 1.15rem; font-weight: bold; color: #ffffff;
            margin-bottom: 6px; line-height: 1.5; text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
        }
        .question-hint {
            font-size: 0.82rem; color: #c8d6e5; margin-bottom: 20px; line-height: 1.5;
            border-right: 3px solid #f39c12;
            background: rgba(243,156,18,0.12); padding: 10px 12px;
            border-radius: 0 8px 8px 0; backdrop-filter: blur(6px);
        }

        .input-group { margin-bottom: 20px; }
        .input-group input[type="number"] {
            width: 100%; padding: 12px 16px;
            border: 2px solid rgba(255,255,255,0.15);
            border-radius: 10px; font-size: 1rem; font-family: inherit;
            color: #ffffff; background: rgba(255,255,255,0.06);
            transition: border-color 0.2s, background 0.2s;
            text-align: right; direction: rtl;
        }
        .input-group input:focus {
            outline: none; border-color: #5a7fb5;
            background: rgba(90,127,181,0.15);
        }
        .input-group input::placeholder { color: rgba(255,255,255,0.4); }

        .choice-buttons { display: flex; flex-direction: column; gap: 10px; margin-bottom: 10px; }
        .btn-choice {
            width: 100%; padding: 13px 16px; font-size: 0.97rem; font-weight: bold;
            border: 2px solid rgba(255,255,255,0.15);
            border-radius: 12px; cursor: pointer;
            background: rgba(255,255,255,0.06); color: #ffffff;
            text-align: right; font-family: inherit;
            transition: border-color 0.2s, background 0.2s, transform 0.15s;
            backdrop-filter: blur(6px);
        }
        .btn-choice:hover {
            border-color: #5a7fb5; background: rgba(90,127,181,0.2);
            transform: translateX(-3px);
        }
        .btn-choice.selected {
            background: linear-gradient(135deg, #5a7fb5, #4a6fa5);
            color: white; border-color: #4a6fa5;
            box-shadow: 0 4px 12px rgba(90,127,181,0.4);
        }

        .yn-buttons { display: flex; gap: 12px; margin-bottom: 10px; }
        .btn-yes, .btn-no {
            flex: 1; padding: 14px; font-size: 1.05rem; font-weight: bold;
            border: none; border-radius: 12px; cursor: pointer;
            transition: transform 0.15s, box-shadow 0.15s; font-family: inherit;
        }
        .btn-yes {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white; box-shadow: 0 4px 12px rgba(39,174,96,0.3);
        }
        .btn-yes:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(39,174,96,0.5); }
        .btn-no {
            background: linear-gradient(135deg, #c0392b, #e74c3c);
            color: white; box-shadow: 0 4px 12px rgba(192,57,43,0.3);
        }
        .btn-no:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(192,57,43,0.5); }
        .btn-yes.selected { outline: 3px solid #145a32; }
        .btn-no.selected  { outline: 3px solid #7b241c; }

        .btn-next {
            width: 100%; padding: 13px;
            background: linear-gradient(135deg, #5a7fb5, #4a6fa5);
            color: white; border: none; border-radius: 12px;
            font-size: 1rem; font-weight: bold; cursor: pointer; font-family: inherit;
            transition: transform 0.15s, box-shadow 0.15s;
            box-shadow: 0 4px 12px rgba(90,127,181,0.3); margin-top: 8px;
        }
        .btn-next:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(90,127,181,0.5); }
        .btn-next:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }

        .result-card {
            display: none; border-radius: 24px; padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            text-align: center;
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1.5px solid rgba(255,255,255,0.15);
        }
        .result-icon { font-size: 4rem; margin-bottom: 15px; }
        .result-title { font-size: 1.6rem; font-weight: bold; margin-bottom: 10px; }
        .result-title.sell   { color: #e74c3c; text-shadow: 0 0 10px rgba(231,76,60,0.5); }
        .result-title.hold   { color: #2ecc71; text-shadow: 0 0 10px rgba(46,204,113,0.5); }
        .result-title.review { color: #f39c12; text-shadow: 0 0 10px rgba(243,156,18,0.5); }

        .result-summary {
            font-size: 0.95rem; color: #d0e1f9; line-height: 1.7;
            margin-bottom: 20px; text-align: right;
        }

        .factors-section {
            background: rgba(255,255,255,0.06); border-radius: 12px;
            padding: 18px; margin-bottom: 20px; text-align: right;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .factors-section h4 {
            font-size: 0.95rem; color: #ffffff; font-weight: bold; margin-bottom: 12px;
        }
        .factor-item {
            display: flex; align-items: flex-start; gap: 10px;
            margin-bottom: 8px; font-size: 0.88rem; color: #c8d6e5; line-height: 1.5;
        }
        .factor-dot {
            width: 10px; height: 10px; border-radius: 50%; margin-top: 4px; flex-shrink: 0;
        }
        .dot-sell { background: #e74c3c; }
        .dot-hold { background: #27ae60; }
        .dot-neutral { background: #f39c12; }

        .score-meter { margin: 20px 0; }
        .score-label {
            display: flex; justify-content: space-between;
            font-size: 0.8rem; color: #c8d6e5; margin-bottom: 6px;
        }
        .score-bar-wrap {
            background: rgba(255,255,255,0.08); border-radius: 10px; height: 14px; overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .score-bar-fill { height: 100%; border-radius: 10px; transition: width 0.6s ease; }
        .score-text { font-size: 0.85rem; color: #d0e1f9; margin-top: 6px; text-align: center; }

        .btn-restart {
            display: inline-block; padding: 12px 30px;
            background: linear-gradient(135deg, #5a7fb5, #4a6fa5);
            color: white; border: none; border-radius: 12px;
            font-size: 0.95rem; font-weight: bold; cursor: pointer; font-family: inherit;
            transition: transform 0.15s; margin-top: 10px;
        }
        .btn-restart:hover { transform: translateY(-2px); }

        .back-to-top {
            position: fixed; bottom: 30px; left: 30px;
            background: linear-gradient(135deg, #5a7fb5, #4a6fa5);
            color: white; border: none; border-radius: 50%;
            width: 48px; height: 48px; font-size: 1.3rem; cursor: pointer;
            box-shadow: 0 4px 15px rgba(90,127,181,0.4);
            transition: transform 0.3s, opacity 0.3s;
            opacity: 0; pointer-events: none;
            display: flex; align-items: center; justify-content: center; z-index: 999;
        }
        .back-to-top.visible { opacity: 1; pointer-events: auto; }
        .back-to-top:hover { transform: translateY(-3px); }

        .disclaimer-box {
            background: rgba(243,156,18,0.12); border: 2px solid rgba(243,156,18,0.3);
            border-radius: 12px; padding: 14px 16px; margin-top: 20px;
            color: #ffa726; font-weight: bold; font-size: 0.85rem; line-height: 1.6;
            backdrop-filter: blur(6px); text-align: center;
        }

        .override-alert {
            background: rgba(231,76,60,0.15); border: 2px solid #e74c3c;
            border-radius: 12px; padding: 15px; margin-bottom: 20px;
            color: #ffcccc; font-weight: bold; text-align: right;
        }

        @media (max-width: 600px) {
            .page-header h1 { font-size: 1.7rem; }
            .advisor-card { padding: 20px; }
            .question-text { font-size: 1rem; }
            .yn-buttons { flex-direction: column; }
        }
    </style>
</head>
<body>

<button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" title="ุงูุนูุฏุฉ ููุฃุนูู">โ</button>

<div class="container">
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">๐ ูููุฑุฉ ูุณุชุซูุฑ</a>
            <button class="navbar-toggle" onclick="toggleNavbar()">โฐ</button>
            <div class="navbar-menu" id="navbarMenu">
                <a href="index.html" class="navbar-item">๐ ุงูุฑุฆูุณูุฉ</a>
                <a href="advice.html" class="navbar-item calculator">๐ฐ ุตุงูู ุงูุซุฑูุฉ</a>
                <a href="salary_calculator.html" class="navbar-item salary">๐ผ ุชูุณูู ุงูุฑุงุชุจ</a>
                <a href="zakat_purification.html" class="navbar-item zakat">๐ ุงูุฒูุงุฉ</a>
                <a href="financial_freedom.html" class="navbar-item fire">๐ฅ ุงูุญุฑูุฉ ุงููุงููุฉ</a>
                <a href="investor_tips.html" class="navbar-item tips">โ๏ธ ูุตุงุฆุญ</a>
                <a href="snowball_calculator.html" class="navbar-item calculator">โ๏ธ ุงูุนุงุฆุฏ ุงููุฑูุจ</a>
                <a href="emergency_fund_calculator.html" class="navbar-item emergency">๐ก๏ธ ุงูุทูุงุฑุฆ</a>
                <a href="average_calculator.html" class="navbar-item average">๐ ูุชูุณุท ุงูุดุฑุงุก</a>
                <a href="company_valuation.html" class="navbar-item company">๐ข ุชูููู ุงูุดุฑูุฉ</a>
                <a href="retirement_calculator.html" class="navbar-item retirement">๐๏ธ ุงูุชูุงุนุฏ</a>
                <a href="portfolio_rating.html" class="navbar-item portfolio">๐ก๏ธ ุฃูุงู ุงููุญูุธุฉ</a>
                <a href="stock_valuation.html" class="navbar-item calculator">๐ ุชูููู ุงูุฃุณูู</a>
                <a href="dca_calculator.html" class="navbar-item calculator">๐ DCA</a>
                <a href="sell_decision.html" class="navbar-item calculator active">๐ค ูู ุฃุจูุนุ</a>
                <a href="goal_calculator.html" class="navbar-item calculator">๐ฏ ุงููุฏู ุงูุนูุณู</a>
                <a href="allocation_calculator.html" class="navbar-item allocation">โ๏ธ ุชูุฒูุน ุงููุญูุธุฉ</a>
            </div>
        </div>
    </nav>

    <div class="page-header">
        <h1>๐ค ูู ุฃุจูุน ุณูููุ</h1>
        <p>ุฌุงูุจ ุจุตุฏู ุนูู ุงูุฃุณุฆูุฉ ููุญุตูู ุนูู ุชุญููู ูุงูู ููุถูุนู ูุฌุฑุฏ ูู ุงูุนูุงุทู.</p>
    </div>

    <div class="advisor-card" id="questionCard">
        <div class="progress-label"><span id="progressText">ุงูุณุคุงู 1 ูู 12</span></div>
        <div class="progress-bar-wrap"><div class="progress-bar-fill" id="progressBar"></div></div>
        <div id="questionBody"></div>
    </div>

    <div class="result-card" id="resultCard"></div>

    <div class="disclaimer-box">
        โ๏ธ ูุฐู ุงูุฃุฏุงุฉ ุชุนููููุฉ ุฅุฑุดุงุฏูุฉ ููุท ููุง ุชุนุฏ ุชูุตูุฉ ูุงููุฉ. ูุฑุงุฑ ุงูุงุณุชุซูุงุฑ ููุน ุนูู ุนุงุชูู. ุงุณุชุดุฑ ูุณุชุดุงุฑุงู ูุฑุฎุตุงู ูุจู ุงูุชูููุฐ.
    </div>
</div>

<script src="results-engine.js"></script>
<script>
function toggleNavbar() { document.getElementById('navbarMenu').classList.toggle('open'); }

const SellDecisionApp = (function() {
    const questions = [
        { id: 'q1', type: 'choice', text: 'ูุง ูู ุงูุณุจุจ ุงูุฑุฆูุณู ููุจูุท ุงูุณููุ', hint: 'ุงุฎุชุฑ ุงููุตู ุงูุฃูุฑุจ ููุงูุน ุงูุณูู ุงูุญุงูู.', choices: [
            { label: '๐ ุงูุณูู ุจุฃูููู ูุงุจุท ูุงูุณูู ุชุฃุซุฑ ุชุจุนุง ูุฐูู', weight: 3, hint: 'ูุจูุท ุงูุณูู ุงูุนุงู ููุฏู ูุฑุตุง ุชุงุฑูุฎูุฉ. ุงูุชุณููู ูู ููุฌุงุช ุงูุชุตุญูุญ ุงูุนุงูุฉ ูุฏูุฑ ุงูุนูุงุฆุฏ.' },
            { label: '๐ฐ ุฅุนูุงู ุฃู ุฎุจุฑ ุณูุจู ูุฎุต ุงูุดุฑูุฉ', weight: -1, hint: 'ุงูุฃุฎุจุงุฑ ุงูุณูุจูุฉ ุชุชุทูุจ ุชููููุง ุจุงุฑุฏุง ูุฃุซุฑูุง ุนูู ุงูุฃุฑุจุงุญ ุงููุณุชูุจููุฉ ูุจู ุงุชุฎุงุฐ ุงููุฑุงุฑ.' },
            { label: '๐ ุชุฑุงุฌุน ูุนูู ูู ุฃุฑุจุงุญ ุงูุดุฑูุฉ ุฃู ุชูุฒูุนุงุชูุง', weight: -2, hint: 'ุงูุชุฑุงุฌุน ุงูุชุดุบููู ูุดูู ุชุญุฐูุฑุง ุจููููุง ูุณุชูุฌุจ ูุฑุงุฌุนุฉ ุฌุฏูู ุงูุงุณุชุซูุงุฑ.' },
            { label: 'โ ูุง ุฃุนุฑู ุงูุณุจุจ', weight: 2, hint: 'ุงูุจูุน ุจุฏูู ุฅุฏุฑุงู ุงูุฃุณุจุงุจ ูุฑุงุฑ ูุจูู ุนูู ุงูุนุงุทูุฉ. ุชูุตู ุงูุญูุงุฆู ุฃููุง.' }
        ]},
        { id: 'q2', type: 'number', text: 'ูู ูุจูุบ ูุชูุณุท ุชูููุฉ ุงูุดุฑุงุกุ', hint: 'ุฃุฏุฎู ูุชูุณุท ุงูุณุนุฑ ุงูุฐู ุงุดุชุฑูุช ุจู ุงูุณูู.', placeholder: 'ูุซุงู: 45.50', key: 'costPrice' },
        { id: 'q3', type: 'number', text: 'ูู ูุจูุบ ุงูุณุนุฑ ุงูุญุงูู ููุณููุ', hint: 'ุงูุณุนุฑ ุงูุณููู ุงููุนุฑูุถ ูู ููุตุฉ ุงูุชุฏุงูู ุญุงููุง.', placeholder: 'ูุซุงู: 38.00', key: 'currentPrice' },
        { id: 'q4', type: 'choice', text: 'ููู ุชููู ุฑุจุญูุฉ ุงูุดุฑูุฉุ', hint: 'ุฑุงุฌุน ุฃุญุฏุซ ุงูููุงุฆู ุงููุงููุฉ ุฃู ููุฎุต ุงููุชุงุฆุฌ.', choices: [
            { label: 'โ ุงูุดุฑูุฉ ุชุญูู ุฃุฑุจุงุญุง ูุณุชูุฑุฉ ุฃู ูุชูุงููุฉ', weight: 3, hint: 'ุงูุฑุจุญูุฉ ุงููุณุชูุฑุฉ ุชูุซู ุญุฌุฑ ุงูุฃุณุงุณ ูุฃู ุงุณุชุซูุงุฑ ุทููู ุงูุฃุฌู.' },
            { label: '๐ ุงูุดุฑูุฉ ุฑุงุจุญุฉ ููู ุงูุฃุฑุจุงุญ ุชุฑุงุฌุนุช ูุคุฎุฑุง', weight: 0, hint: 'ูุชุทูุจ ุงูุฃูุฑ ุงูุชูุฑูู ุจูู ุชุฑุงุฌุน ุฏูุฑู ุทุจูุนู ุฃู ุถุนู ููููู ูู ูููุฐุฌ ุงูุนูู.' },
            { label: 'โ ุงูุดุฑูุฉ ุชุณุฌู ุฎุณุงุฆุฑ ุฃู ุชูุงุฑุจ ููุทุฉ ุงูุชุนุงุฏู', weight: -3, hint: 'ุบูุงุจ ุงูุฑุจุญูุฉ ูุน ุบูุงุจ ุฎุทุฉ ุชุนุงูู ูุงุถุญุฉ ูุฑูุน ูุนุฏู ุงููุฎุงุทุฑุฉ ุจุดุฏุฉ.' }
        ]},
        { id: 'q5', type: 'choice', text: 'ูุง ูู ุณุฌู ุชูุฒูุนุงุช ุงูุฃุฑุจุงุญ ููุดุฑูุฉุ', hint: 'ุชูููู ุฃุฏุงุก ุงูุชูุฒูุนุงุช ุฎูุงู ุงูุณููุงุช ุงูุซูุงุซ ุฅูู ุงูุฎูุณ ุงููุงุถูุฉ.', choices: [
            { label: '๐ฐ ุชูุฒูุนุงุช ููุชุธูุฉ ููุณุชูุฑุฉ ุฃู ูุชูุงููุฉ', weight: 3, hint: 'ุงูุชูุฒูุน ุงููุณุชูุฑ ูุนูุณ ุงูุถุจุงุทุง ุฅุฏุงุฑูุง ูุชุฏููุงุช ููุฏูุฉ ุตุญูุฉ.' },
            { label: '๐ ุชูุฒูุนุงุช ููุฌูุฏุฉ ููููุง ูุชุฐุจุฐุจุฉ', weight: 1, hint: 'ุงูุชุฐุจุฐุจ ููุจูู ูู ุงููุทุงุนุงุช ุงูุฏูุฑูุฉ ุทุงููุง ูู ููุณ ุฃุณุงุณูุงุช ุงูุดุฑูุฉ.' },
            { label: 'โฌ๏ธ ุชู ุชูููุต ุงูุชูุฒูุนุงุช ุจุดูู ููุญูุธ', weight: -2, hint: 'ุชูููุต ุงูุชูุฒูุน ูุนุฏ ุฑุณุงูุฉ ูุจุงุดุฑุฉ ูู ุงูุฅุฏุงุฑุฉ ุจูุฌูุฏ ุถุบูุท ูุงููุฉ.' },
            { label: '๐ซ ุงูุดุฑูุฉ ูุง ุชูุฒุน ุฃุฑุจุงุญุง', weight: -1, hint: 'ููุจูู ููุท ุฅุฐุง ูุงูุช ุงูุดุฑูุฉ ุชุนูุฏ ุงุณุชุซูุงุฑ ุงูุฃุฑุจุงุญ ุจุนูุงุฆุฏ ุนุงููุฉ ูุซุจุชุฉ.' }
        ]},
        { id: 'q6', type: 'choice', text: 'ูุง ูู ุญุฌู ุงูุฏููู ุนูู ุงูุดุฑูุฉุ', hint: 'ุชูุฏูุฑ ุนุงู ููุณุชูู ุงูุฑุงูุนุฉ ุงููุงููุฉ ููุดุฑูุฉ.', choices: [
            { label: 'โ ุฏููู ููุฎูุถุฉ ุฃู ุชุชูุงุณุจ ูุน ุงูุฃุฑุจุงุญ', weight: 2, hint: 'ุงูููุฒุงููุฉ ุงููุชุญูุธุฉ ุชุฎูุถ ุงููุฎุงุทุฑ ูู ูุชุฑุงุช ุงุฑุชูุงุน ุงููุงุฆุฏุฉ.' },
            { label: 'โ๏ธ ุชูุฌุฏ ุฏููู ููู ุงูุชุฏููุงุช ุชุบุทููุง', weight: 1, hint: 'ุงููุถุน ููุจูู ุชุดุบูููุงุ ููู ุฃู ูุจูุท ุญุงุฏ ูู ุงูุฅูุฑุงุฏุงุช ุณูุดูู ุฎุทุฑุง.' },
            { label: '๐ด ุฏููู ุนุงููุฉ ุชุดูู ูุตุฏุฑ ููู', weight: -2, hint: 'ุงูุฑุงูุนุฉ ุงููุงููุฉ ุงููุฑุชูุนุฉ ูุน ุชุฐุจุฐุจ ุงูุฃุฑุจุงุญ ุชูุซู ูุตูุฉ ูููุฎุงุทุฑ ุงูุนุงููุฉ.' },
            { label: 'โ ูุง ุชูุฌุฏ ูุฏู ูุนูููุงุช', weight: 0, hint: 'ุฌูู ูุณุชูู ุงูุฏูู ูุนุงุฏู ุงูุงุณุชุซูุงุฑ ุงูุฃุนูู. ูุฌุจ ุงูุชุญูู ูู ูุณุจุฉ ุงูุฏูู ูุญููู ุงูููููุฉ.' }
        ]},
        { id: 'q7', type: 'choice', text: 'ูู ุชุญุชุงุฌ ุฅูู ุชุณููู ูุฐุง ุงููุจูุบ ุงููุงุฏู ุญุงููุงุ', hint: 'ุชูููู ุงูุญุงุฌุฉ ุงููุนููุฉ ุงูุทุงุฑุฆุฉ ููุณูููุฉ.', choices: [
            { label: '๐ด ูุนูุ ูุงูุชุฒุงู ูุงูู ุถุฑูุฑู ูุง ูููู ุชุฃุฌููู', weight: 0, hint: 'ุงูุถุฑูุฑุงุช ุงููุงููุฉ ุชุจูุญ ุงูุชุณููู ุจุบุถ ุงููุธุฑ ุนู ุฌูุฏุฉ ุงูุฃุตู.', isEmergency: true },
            { label: '๐ก ูุฏ ุฃุญุชุงุฌ ุงููุจูุบ ุฎูุงู ุณุชุฉ ุฃุดูุฑ', weight: -1, hint: 'ุงูุฎูู ูู ุงูุจูุน ูู ุงููุงุน ูุชุทูุจ ุงุณุชุฑุงุชูุฌูุฉ ุชุณููู ุชุฏุฑูุฌูุฉ.' },
            { label: '๐ข ูุงุ ุงููุจูุบ ูุฎุตุต ููุงุณุชุซูุงุฑ ููุง ุฃุญุชุงุฌู ูุฑูุจุง', weight: 2, hint: 'ุงูููุช ูุฎุฏู ุงููุณุชุซูุฑ ููููุญู ุงููุฏุฑุฉ ุนูู ุงูุชุตุงุต ุงูุชููุจุงุช ุงูุณุนุฑูุฉ.' }
        ]},
        { id: 'q8', type: 'yn', text: 'ูู ุงุทูุนุช ุนูู ุฃุญุฏุซ ุงููุชุงุฆุฌ ุงููุงููุฉ ููุดุฑูุฉุ', hint: 'ูุฑุงุฌุนุฉ ุงูุฃุฑุจุงุญ ูุงูุฅูุฑุงุฏุงุช ูุงูุชุฏููุงุช ุงูููุฏูุฉ.', weightYes: 1, weightNo: -2, hintYes: 'ุงูุงุณุชุซูุงุฑ ุงููุจูู ุนูู ูุฑุงุกุฉ ุงูุฃุฑูุงู ูููู ูู ูุณุจ ุงูุฎุทุฃ.', hintNo: 'ุงูุจูุน ุจุฏูู ูุญุต ุงูุฃุฑูุงู ูุฌุนู ุงููุฑุงุฑ ุนุดูุงุฆูุง ูุนุงุทููุง.' },
        { id: 'q9', type: 'choice', text: 'ูุง ูู ูุถุน ูุญูุธุชู ุงูุญุงูู ูุน ูุฐุง ุงูุณููุ', hint: 'ููุงุฑูุฉ ูุณุจุฉ ุงูุชุบูุฑ ุจูุงุก ุนูู ุงูุชูููุฉ.', choices: [
            { label: '๐ ุงูุณูู ูุญูู ูุฑุจุญ ูุชุฌุงูุฒ 20%', weight: -1, hint: 'ุงูุฃุฑุจุงุญ ุงููุญููุฉ ุชุชุทูุจ ุชููููุง ููุง ุฅุฐุง ูุงู ุงูุณุนุฑ ูุฏ ุชุฌุงูุฒ ุงููููุฉ ุงูุนุงุฏูุฉ.' },
            { label: 'โ๏ธ ุงูุณุนุฑ ูุฑูุจ ูู ุงูุชูููุฉ (ุชุญุช 20%)', weight: 1, hint: 'ุงูุฃุณุงุณูุงุช ูู ุงูุญุงูู ุงูุฑุฆูุณู ูููุฑุงุฑ ููุง ูููุณ ุงูุณุนุฑ.' },
            { label: '๐ ุชูุฌุฏ ุฎุณุงุฑุฉ ุชุชุฑุงูุญ ุจูู 20% ู 40%', weight: -1, hint: 'ูุฌุจ ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุงููุจูุท ุฏูุฑูุง ุฃู ูููููุง.' },
            { label: '๐ป ุชูุฌุฏ ุฎุณุงุฑุฉ ุชุชุฌุงูุฒ 40%', weight: -2, hint: 'ุงููุฑุงุฌุนุฉ ุงูุนูููุฉ ููุตุฉ ุงูุงุณุชุซูุงุฑ ุถุฑูุฑูุฉ ูู ูุฐู ุงููุฑุญูุฉ.' }
        ]},
        { id: 'q10', type: 'yn', text: 'ูู ุชูุฌุฏ ูุฑุตุฉ ุงุณุชุซูุงุฑูุฉ ุจุฏููุฉ ูุฏุฑูุณุฉ ูููู ุงูุณูููุฉ ุฅูููุงุ', hint: 'ูุฌูุฏ ุจุฏูู ูุจูู ุนูู ุจุญุซ ุฏููู ูููุณ ูุฌุฑุฏ ุชููุน.', weightYes: -1, weightNo: 2, hintYes: 'ููู ุงูุณูููุฉ ูุญู ุฃุตู ุฐู ุนุงุฆุฏ ูุชููุน ุฃุนูู ูู ุฅุฌุฑุงุก ุงุณุชุฑุงุชูุฌู ุณููู.', hintNo: 'ุงูุชุณููู ููุจูุงุก ูุฃุฑุตุฏุฉ ููุฏูุฉ ุจุฏูู ุฎุทุฉ ูููู ูู ููุงุกุฉ ุงููุญูุธุฉ.' },
        { id: 'q11', type: 'yn', text: 'ูู ุงูุฑุบุจุฉ ูู ุงูุจูุน ูุงุชุฌุฉ ุจุดูู ุฃุณุงุณู ุนู ุถุบุท ููุณู ุฃู ุฎููุ', hint: 'ุชูููู ุงูุฏุงูุน ุงูุนุงุทูู ุฎูู ุงููุฑุงุฑ.', weightYes: 3, weightNo: -1, hintYes: 'ุชุฌูุจ ุงุชุฎุงุฐ ูุฑุงุฑุงุช ุงูุชุณููู ุชุญุช ูุทุฃุฉ ุงูุฐุนุฑ ุงูุณุนุฑู.', hintNo: 'ุงููุฑุงุฑุงุช ุงููุจููุฉ ุนูู ุงูููุทู ุฃุซุจุช ุฌุฏูู.' },
        { id: 'q12', type: 'choice', text: 'ูุง ูู ุงููุฏุฉ ุงูุชู ุงุญุชูุธุช ูููุง ุจุงูุณููุ', hint: 'ููุงุณ ุฃูู ุงูุงุณุชุซูุงุฑ ุงููุนูู.', choices: [
            { label: '๐ ุฃูู ูู ุณุชุฉ ุฃุดูุฑ', weight: 0, hint: 'ุชููุจุงุช ุงููุฏู ุงููุตูุฑ ุชุนุชุจุฑ ุถูุถุงุก ุณุนุฑูุฉ ุบุงูุจุง.' },
            { label: '๐ ูู ุณุชุฉ ุฃุดูุฑ ุฅูู ุณูุชูู', weight: 1, hint: 'ุชุนุชุจุฑ ูุฏุฉ ููุงุณุจุฉ ููุจุฏุก ุจุชูููู ุตุญุฉ ุงูุงูุชุฑุงุถุงุช ุงูุงุณุชุซูุงุฑูุฉ.' },
            { label: '๐ ุฃูุซุฑ ูู ุณูุชูู', weight: 2, hint: 'ุงูุงุญุชูุงุธ ุทููู ุงููุฏู ูุฎุถุน ูุฏูุฑุฉ ุฃุนูุงู ูุงููุฉ.' }
        ]}
    ];

    let currentQ = 0;
    let scores = [];
    let answers = {};
    let pendingValue = null;

    function render() {
        const q = questions[currentQ];
        const pct = Math.round((currentQ / questions.length) * 100);
        
        document.getElementById('progressBar').style.width = pct + '%';
        document.getElementById('progressText').textContent = `ุงูุณุคุงู ${currentQ + 1} ูู ${questions.length}`;

        let html = `<div class="question-number">ุงูุณุคุงู ${currentQ + 1}</div>
                    <div class="question-text">${q.text}</div>
                    <div class="question-hint">${q.hint}</div>`;

        if (q.type === 'choice') {
            html += `<div class="choice-buttons">`;
            q.choices.forEach((c, idx) => {
                html += `<button class="btn-choice" onclick="SellDecisionApp.selectChoice(${idx})">${c.label}</button>`;
            });
            html += `</div>
                     <div id="choiceHint" style="font-size:0.82rem;color:#c8d6e5;min-height:36px;margin-bottom:10px;"></div>
                     <button class="btn-next" id="btnNext" onclick="SellDecisionApp.next()" disabled>ุงูุชุงูู โ</button>`;
        } else if (q.type === 'yn') {
            html += `<div class="yn-buttons">
                        <button class="btn-yes" id="btnYes" onclick="SellDecisionApp.selectYN('yes')">โ ูุนู</button>
                        <button class="btn-no" id="btnNo" onclick="SellDecisionApp.selectYN('no')">โ ูุง</button>
                     </div>
                     <div id="ynHint" style="font-size:0.82rem;color:#c8d6e5;min-height:36px;margin-bottom:10px;"></div>
                     <button class="btn-next" id="btnNext" onclick="SellDecisionApp.next()" disabled>ุงูุชุงูู โ</button>`;
        } else if (q.type === 'number') {
            html += `<div class="input-group">
                        <input type="number" id="numInput" placeholder="${q.placeholder}" min="0" step="0.01" oninput="SellDecisionApp.validateNum()">
                     </div>
                     <button class="btn-next" id="btnNext" onclick="SellDecisionApp.next()" disabled>ุงูุชุงูู โ</button>`;
        }

        document.getElementById('questionBody').innerHTML = html;
        pendingValue = null;

        if (q.type === 'number') {
            setTimeout(() => document.getElementById('numInput').focus(), 100);
        }
    }

    function selectChoice(idx) {
        pendingValue = idx;
        const buttons = document.querySelectorAll('.btn-choice');
        buttons.forEach((b, i) => b.classList.toggle('selected', i === idx));
        document.getElementById('choiceHint').textContent = questions[currentQ].choices[idx].hint;
        document.getElementById('btnNext').disabled = false;
    }

    function selectYN(val) {
        pendingValue = val;
        document.getElementById('btnYes').classList.toggle('selected', val === 'yes');
        document.getElementById('btnNo').classList.toggle('selected', val === 'no');
        const q = questions[currentQ];
        document.getElementById('ynHint').textContent = val === 'yes' ? q.hintYes : q.hintNo;
        document.getElementById('btnNext').disabled = false;
    }

    function validateNum() {
        const v = parseFloat(document.getElementById('numInput').value);
        document.getElementById('btnNext').disabled = isNaN(v) || v <= 0;
    }

    function next() {
        const q = questions[currentQ];
        
        if (q.type === 'choice') {
            const c = q.choices[pendingValue];
            scores.push({ id: q.id, weight: c.weight, text: q.text, hint: c.hint, isEmergency: c.isEmergency });
            answers[q.id] = pendingValue;
        } else if (q.type === 'yn') {
            const w = pendingValue === 'yes' ? q.weightYes : q.weightNo;
            const h = pendingValue === 'yes' ? q.hintYes : q.hintNo;
            scores.push({ id: q.id, weight: w, text: q.text, hint: h });
            answers[q.id] = pendingValue;
        } else if (q.type === 'number') {
            const v = parseFloat(document.getElementById('numInput').value);
            answers[q.key] = v;
            scores.push({ id: q.id, weight: 0, text: q.text, hint: '' });
        }

        currentQ++;
        if (currentQ < questions.length) {
            render();
        } else {
            calculateResult();
        }
    }

    function calculateResult() {
        document.getElementById('questionCard').style.display = 'none';
        document.getElementById('progressBar').style.width = '100%';

        let totalScore = 0;
        scores.forEach(s => totalScore += s.weight);

        const cost = answers.costPrice || 0;
        const current = answers.currentPrice || 0;
        let changePct = 0;
        
        if (cost > 0 && current > 0) {
            changePct = ((current - cost) / cost) * 100;
            // ุงูููุงุฒูุฉ ุงูุณุนุฑูุฉ
            if (changePct > 50) totalScore -= 2; // ุฃุฑุจุงุญ ุงุณุชุซูุงุฆูุฉ ุชูุฌุจ ุฌูู ุงูุฃุฑุจุงุญ
            if (changePct < -50) totalScore -= 1; // ุงูููุงุฑ ุณุนุฑู
        }

        // ุงูููุงูุน ุงููุงุทุนุฉ (Hard Stops)
        const isLiquidityEmergency = scores.find(s => s.isEmergency === true) !== undefined;
        const isFundamentalRuin = answers['q4'] === 2 && answers['q6'] === 2; // ุฎุณุงุฑุฉ ูุณุชูุฑุฉ + ุฏููู ุนุงููุฉ
        const isBlindPanic = answers['q8'] === 'no' && answers['q11'] === 'yes'; // ูู ููุฑุฃ ุงููุชุงุฆุฌ + ุฎุงุฆู

        let decisionType, icon, titleClass, summary, barColor, pct;

        if (isLiquidityEmergency) {
            decisionType = 'ุชุณููู ุงููุญูุธุฉ';
            icon = '๐จ';
            titleClass = 'sell';
            pct = 10;
            barColor = 'linear-gradient(90deg,#c0392b,#e74c3c)';
            summary = 'ุงูุงูุชุฒุงูุงุช ุงููุงููุฉ ุงูุถุฑูุฑูุฉ ููุง ุงูุฃููููุฉ ุงููุตูู. ุงููุงุนุฏุฉ ุงููุงููุฉ ุชูุฌุจ ุชุณููู ุงูุฃุตูู ูุชุบุทูุฉ ุงูุทูุงุฑุฆ ุงูููุฏูุฉ ุจุบุถ ุงููุธุฑ ุนู ุงูุฃุณุงุณูุงุช ุฃู ุฌูุฏุฉ ุงูุณูู.';
        } else if (isFundamentalRuin) {
            decisionType = 'ุฎุฑูุฌ ุฅูุฒุงูู ูุญุชูู';
            icon = '๐ด';
            titleClass = 'sell';
            pct = 20;
            barColor = 'linear-gradient(90deg,#c0392b,#e74c3c)';
            summary = 'ุงูุฃุณุงุณูุงุช ุชุดูุฑ ุฅูู ูููู ูุงูู ูุชุฏุงุนู (ุฎุณุงุฆุฑ ูุณุชูุฑุฉ ูุฏููู ูุฑุชูุนุฉ). ุงูุชูุณู ุจูุฐุง ุงูุณูู ูุญูู ูุฎุงุทุฑ ุงุถูุญูุงู ุฑุฃุณ ุงููุงู.';
        } else if (isBlindPanic) {
            decisionType = 'ุฅููุงู ุงูุชุฏุงูู ูููุฑุงุฌุนุฉ';
            icon = 'โ';
            titleClass = 'review';
            pct = 40;
            barColor = 'linear-gradient(90deg,#f39c12,#f1c40f)';
            summary = 'ุฃูุช ุชุชุฎุฐ ูุฑุงุฑุง ุจูุงุก ุนูู ุงูุฎูู ุฏูู ูุฑุงุกุฉ ุงููุชุงุฆุฌ ุงููุงููุฉ. ุฃููู ุชูููุฐ ุงูุจูุน ูุงูุฑุฃ ุงูููุงุฆู ุงููุงููุฉ ุฃู ุงุณุชุดุฑ ุฎุจูุฑุง ุฃููุง.';
        } else {
            // ุงููุณุงุฑ ุงูุทุจูุนู
            const maxScore = 20;
            const minScore = -20;
            pct = Math.min(100, Math.max(0, ((totalScore - minScore) / (maxScore - minScore)) * 100));

            if (totalScore >= 7) {
                decisionType = 'ุงุญุชูุงุธ ุงุณุชุฑุงุชูุฌู';
                icon = '๐ข';
                titleClass = 'hold';
                barColor = 'linear-gradient(90deg,#27ae60,#2ecc71)';
                summary = 'ุงููุคุดุฑุงุช ุงูุฃุณุงุณูุฉ ูุงูุณููููุฉ ุชุชูุงูู ูุน ุงูุฅุจูุงุก ุนูู ุงูุงุณุชุซูุงุฑ. ุงูุชุฐุจุฐุจ ุงูุณุนุฑู ุงูุญุงูู ูุง ูุจุฑุฑ ุชุณููู ุงููุฑูุฒ ุงููุงูู.';
            } else if (totalScore >= 1) {
                decisionType = 'ูุฑุงุฌุนุฉ ูุชุฎููู ูุฎุงุทุฑ';
                icon = '๐ก';
                titleClass = 'review';
                barColor = 'linear-gradient(90deg,#f39c12,#f1c40f)';
                summary = 'ูุธูุฑ ุงูุชูููู ุญุงูุฉ ูู ุงูุชูุงุฒู ุจูู ุงููุฎุงุทุฑ ูุงููุฑุต. ููุตุญ ุจุงูุงุญุชูุงุธ ูุน ูุถุน ุญุฏ ุฅููุงู ุฎุณุงุฑุฉ ุตุงุฑูุ ุฃู ุฌูู ุฃุฑุจุงุญ ุฌุฒุฆู ุฅุฐุง ุญูู ุงูุณูู ุนุงุฆุฏุง ูุฌุฒูุง.';
            } else {
                decisionType = 'ุชุณููู ููุธู';
                icon = '๐ด';
                titleClass = 'sell';
                barColor = 'linear-gradient(90deg,#c0392b,#e74c3c)';
                summary = 'ุงูุนูุงูู ุงูุณูุจูุฉ ุชุชููู ุนูู ูุจุฑุฑุงุช ุงูุงุญุชูุงุธ. ูุนุชุจุฑ ุงูุฎุฑูุฌ ุงูุชุฏุฑูุฌู ุฃู ููู ุงูุณูููุฉ ูุญู ุฃุตูู ุฃุนูู ุฌูุฏุฉ ุฎูุงุฑุง ููุทููุง ูุญูุงูุฉ ุงููุญูุธุฉ.';
            }
        }

        let overrideAlert = '';
        if (isLiquidityEmergency || isFundamentalRuin || isBlindPanic) {
            overrideAlert = `<div class="override-alert">ุชู ุชุทุจูู ูุธุงู ุงูุญูุงูุฉ ุงูุขูู ุจูุงุก ุนูู ุงููุฏุฎูุงุช ุงูุญุฑุฌุฉ ูุชุฌุงูุฒุง ูุธุงู ุงูููุงุท ุงูุนุงุฏู.</div>`;
        }

        let factorsHTML = '';
        scores.forEach(s => {
            if (s.weight === 0 || !s.hint) return;
            const dotClass = s.weight > 0 ? 'dot-hold' : 'dot-sell';
            factorsHTML += `<div class="factor-item"><div class="factor-dot ${dotClass}"></div><div>${s.hint}</div></div>`;
        });

        let priceNote = '';
        if (cost > 0 && current > 0) {
            const sign = changePct >= 0 ? '+' : '';
            const color = changePct >= 0 ? '#2ecc71' : '#e74c3c';
            priceNote = `<p style="font-size:0.9rem;color:${color};font-weight:bold;margin-bottom:15px;direction:ltr;">
                            ุงูุชูููุฉ: ${cost.toFixed(2)} | ุงูุญุงูู: ${current.toFixed(2)} | ุงูุชุบูุฑ: ${sign}${changePct.toFixed(1)}%
                         </p>`;
        }

        const rc = document.getElementById('resultCard');
        rc.innerHTML = `
            ${overrideAlert}
            <div class="result-icon">${icon}</div>
            <div class="result-title ${titleClass}">${decisionType}</div>
            ${priceNote}
            <p class="result-summary">${summary}</p>
            <div class="score-meter">
                <div class="score-label"><span>ุชุณููู</span><span>ุงุญุชูุงุธ</span></div>
                <div class="score-bar-wrap"><div class="score-bar-fill" style="width:${Math.round(pct)}%;background:${barColor};"></div></div>
                <div class="score-text">ูุคุดุฑ ุงููุฑุงุฑ: ${Math.round(pct)}%</div>
            </div>
            <div class="factors-section">
                <h4>๐ ุฃุจุฑุฒ ุงูููุงุญุธุงุช ุงูุชุญููููุฉ:</h4>
                ${factorsHTML || '<p style="color:#888;font-size:0.85rem;">ูุง ุชูุฌุฏ ุนูุงูู ุชุญููููุฉ ุจุงุฑุฒุฉ.</p>'}
            </div>
            <button class="btn-restart" onclick="SellDecisionApp.restart()">๐ ุชูููู ุณูู ุฌุฏูุฏ</button>
        `;
        
        rc.style.display = 'block';
        rc.classList.remove('result-positive','result-negative','result-warning');
        if (titleClass === 'hold') rc.classList.add('result-positive');
        if (titleClass === 'sell') rc.classList.add('result-negative');
        if (titleClass === 'review') rc.classList.add('result-warning');

        if (window.ResultsEngine) window.ResultsEngine.paint();
        rc.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function restart() {
        currentQ = 0;
        scores = [];
        answers = {};
        pendingValue = null;
        
        const rc = document.getElementById('resultCard');
        rc.style.display = 'none';
        rc.classList.remove('result-positive','result-negative','result-warning');
        
        document.getElementById('questionCard').style.display = 'block';
        render();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    return { init: render, selectChoice, selectYN, validateNum, next, restart };
})();

window.addEventListener('scroll', function () {
    const btn = document.getElementById('backToTop');
    if(btn) btn.classList.toggle('visible', window.scrollY > 300);
});

document.addEventListener('DOMContentLoaded', SellDecisionApp.init);
</script>
</body>
</html>
