<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ‚ÙŠÙŠÙ… Ø¬ÙˆØ¯Ø© Ø§Ù„Ø´Ø±ÙƒØ© | Ù…ÙÙƒØ±Ø© Ù…Ø³ØªØ«Ù…Ø±</title>
    <link rel="stylesheet" href="navigation.css">
    <!-- âœ… defer: Ù„Ø§ ÙŠÙØ¨Ø·Ø¦ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);
            min-height: 100vh; padding: 20px; color: #2c3e50;
        }

        /* ===== Container ===== */
        .container {
            max-width: 950px; margin: 0 auto;
            background: white; border-radius: 20px;
            padding: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        /* ===== Legal Banner ===== */
        .legal-banner {
            background: #fff3cd; border: 2px solid #ffc107;
            border-radius: 8px; padding: 12px 16px;
            margin-bottom: 25px;
            display: flex; align-items: center; gap: 12px;
            flex-wrap: wrap;
        }
        .legal-banner span:first-child { font-size: 1.3rem; flex-shrink: 0; }
        .legal-banner p {
            color: #856404; font-weight: bold;
            font-size: 0.88rem; line-height: 1.5; flex: 1;
        }

        /* ===== Header ===== */
        h1 { text-align: center; color: #2c3e50; margin-bottom: 8px; font-size: 2rem; }
        p.subtitle { text-align: center; color: #7f8c8d; margin-bottom: 30px; }

        /* ===== Rule Item ===== */
        .rule-item {
            background: #f8f9fa; border-radius: 15px;
            padding: 25px; margin: 20px 0;
            border-right: 5px solid #4ca1af;
        }
        .rule-item h3 {
            color: #2c3e50; margin-bottom: 20px;
            border-bottom: 1px solid #ddd; padding-bottom: 10px;
        }

        /* ===== Input Grid ===== */
        .input-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
        }
        .input-group { margin-bottom: 5px; }
        .input-group label {
            display: block; font-weight: bold;
            margin-bottom: 7px; font-size: 0.88rem; color: #34495e;
        }
        .input-group input,
        .input-group select {
            width: 100%; padding: 11px; border: 2px solid #e0e0e0;
            border-radius: 8px; font-size: 0.95rem; transition: 0.3s;
            background: white;
        }
        .input-group input:focus,
        .input-group select:focus { border-color: #4ca1af; outline: none; background: #f0f9ff; }

        /* ===== Results ===== */
        .results-section {
            background: #2c3e50; color: white;
            border-radius: 20px; padding: 30px; margin-top: 30px;
        }

        /* âœ… Ø­Ø§Ù„Ø© "Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" */
        .results-section.pending { opacity: 0.65; }

        .result-content {
            display: flex; align-items: center;
            justify-content: space-around; flex-wrap: wrap; gap: 30px;
        }

        .score-display {
            font-size: 4.5rem; font-weight: bold;
            color: #f1c40f; line-height: 1;
        }
        .score-label { color: rgba(255,255,255,0.7); font-size: 0.85rem; margin-top: 4px; }

        .chart-box { width: 180px; height: 180px; }

        .evaluation-badge {
            display: inline-block; padding: 10px 25px;
            border-radius: 50px; margin-top: 14px;
            font-weight: bold; font-size: 1.1rem;
            background: #7f8c8d; /* default */
            transition: background 0.4s;
        }

        .analysis-box {
            margin-top: 25px; padding: 20px;
            background: rgba(255,255,255,0.08);
            border-radius: 10px; font-size: 0.95rem; line-height: 1.8;
        }
        .analysis-box strong { display: block; margin-bottom: 10px; font-size: 1rem; }

        /* âœ… flag ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù† */
        .red-flag {
            color: #ff7675; font-weight: bold;
            margin-top: 12px; display: block; font-size: 0.95rem;
        }

        /* ===== Score color thresholds ===== */
        .score-high   { color: #2ecc71; }
        .score-mid    { color: #3498db; }
        .score-warn   { color: #f39c12; }
        .score-danger { color: #e74c3c; }

        /* ===== Responsive ===== */
        @media (max-width: 768px) {
            .container { padding: 20px; }
            h1 { font-size: 1.6rem; }
            .score-display { font-size: 3rem; }
            .chart-box { width: 140px; height: 140px; }
        }
    </style>
</head>
<body>

<!-- ===== Navbar ===== -->
<nav class="navbar">
    <div class="navbar-container">
        <a href="index.html" class="navbar-brand">ğŸ“ˆ Ù…ÙÙƒØ±Ø© Ù…Ø³ØªØ«Ù…Ø±</a>
        <div class="navbar-menu" id="navbarMenu">
            <a href="index.html"             class="navbar-item">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="company_valuation.html" class="navbar-item active">ğŸ¢ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø´Ø±ÙƒØ©</a>
            <a href="stock_valuation.html"   class="navbar-item">ğŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø³Ù‡Ù…</a>
            <a href="financial_freedom.html" class="navbar-item">ğŸ”¥ Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</a>
            <a href="portfolio_rating.html"  class="navbar-item">ğŸ›¡ï¸ Ø£Ù…Ø§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©</a>
        </div>
        <!-- âœ… Ø²Ø± Ø§Ù„Ø¬ÙˆØ§Ù„ Ù…Ø¶Ø§Ù -->
        <button class="navbar-toggle" onclick="toggleNavbar()">â˜°</button>
    </div>
</nav>

<div class="container">

    <!-- âœ… Legal Banner Ù…Ø¶Ø§Ù -->
    <div class="legal-banner">
        <span>âš ï¸</span>
        <p>Ø¥Ù‚Ø±Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÙŠ: Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© ØªÙ‚Ø¯ÙŠØ±ÙŠØ©. Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ø§ ØªÙÙ…Ø«Ù‘Ù„ Ø§Ø³ØªØ´Ø§Ø±Ø© Ù…Ø§Ù„ÙŠØ© Ù…Ù„Ø²Ù…Ø©.
           Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù…Ø§Ù„ ÙŠÙ†Ø·ÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø®Ø§Ø·Ø±. Ù‚Ø±Ø§Ø± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙŠÙ‚Ø¹ Ø¹Ù„Ù‰ Ø¹Ø§ØªÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ­Ø¯Ù‡.</p>
    </div>

    <h1>ğŸ¢ Ù…Ø­Ù„Ù„ Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ</h1>
    <p class="subtitle">ØªÙ‚ÙŠÙŠÙ… ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ØªØ±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</p>

    <!-- ===== Ø§Ù„Ù‚Ø³Ù… 1 ===== -->
    <div class="rule-item">
        <h3>1ï¸âƒ£ Ø§Ù„ÙƒÙØ§Ø¡Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ© ÙˆØ¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h3>
        <div class="input-grid">
            <div class="input-group">
                <label>Ù†Ù…Ùˆ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)</label>
                <input type="number" id="growth"
                       placeholder="Ù…Ø«Ø§Ù„: 15" step="0.1"
                       oninput="scheduleUpdate()">
            </div>
            <div class="input-group">
                <label>Ø¯ÙˆØ±Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒØ§Ø´ (Ø£ÙŠØ§Ù…)</label>
                <input type="number" id="cashCycle"
                       placeholder="Ø£Ù‚Ù„ Ù…Ù† 40 Ù…Ù…ØªØ§Ø²" min="0"
                       oninput="scheduleUpdate()">
            </div>
            <div class="input-group">
                <label>Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ (Ø§Ù„ÙƒØ§Ø´)</label>
                <select id="cashQuality" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="high">ÙƒØ§Ø´ Ø§Ù„ØªØ´ØºÙŠÙ„ > ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</option>
                    <option value="low">ÙƒØ§Ø´ Ø§Ù„ØªØ´ØºÙŠÙ„ &lt; ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</option>
                </select>
            </div>
        </div>
    </div>

    <!-- ===== Ø§Ù„Ù‚Ø³Ù… 2 ===== -->
    <div class="rule-item">
        <h3>2ï¸âƒ£ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£ØµÙˆÙ„ ÙˆØ§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h3>
        <div class="input-grid">
            <div class="input-group">
                <label>Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù‚ÙˆÙ‚ ROE (%)</label>
                <input type="number" id="roe"
                       placeholder="Ù…Ø«Ø§Ù„: 18" step="0.1"
                       oninput="scheduleUpdate()">
            </div>
            <div class="input-group">
                <label>Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø£ØµÙˆÙ„ (Asset Turnover)</label>
                <select id="assetTurnover" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="high">Ù…Ø±ØªÙØ¹ (ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ©)</option>
                    <option value="mid">Ù…ØªÙˆØ³Ø·</option>
                    <option value="low">Ù…Ù†Ø®ÙØ¶ (Ø®Ù…ÙˆÙ„ ØªØ´ØºÙŠÙ„ÙŠ)</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¯ÙŠÙˆÙ† Ù„Ù„Ø£ØµÙˆÙ„ (%)</label>
                <input type="number" id="debt"
                       placeholder="Ù…Ø«Ø§Ù„: 30" min="0" max="100"
                       oninput="scheduleUpdate()">
            </div>
        </div>
    </div>

    <!-- ===== Ø§Ù„Ù‚Ø³Ù… 3 ===== */-->
    <div class="rule-item">
        <h3>3ï¸âƒ£ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù…ÙŠØ²Ø© Ø§Ù„Ù†ÙˆØ¹ÙŠØ©</h3>
        <div class="input-grid">
            <div class="input-group">
                <label>Ø®Ù†Ø¯Ù‚ ØªÙ†Ø§ÙØ³ÙŠ (Moat)</label>
                <select id="moat" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="strong">Ù‚ÙˆÙŠ (Ø¹Ù„Ø§Ù…Ø© ØªØ¬Ø§Ø±ÙŠØ©/Ø§Ø­ØªÙƒØ§Ø±)</option>
                    <option value="none">Ø¶Ø¹ÙŠÙ (Ø³Ù„Ø¹Ø© Ø¹Ø§Ø¯ÙŠØ©)</option>
                </select>
            </div>
            <div class="input-group">
                <label>ÙƒØ«Ø§ÙØ© Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ (CapEx)</label>
                <select id="capex" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="light">Ø£ØµÙˆÙ„ Ø®ÙÙŠÙØ© (Ù†Ù…Ùˆ ØºÙŠØ± Ù…ÙƒÙ„Ù)</option>
                    <option value="heavy">Ø£ØµÙˆÙ„ Ø«Ù‚ÙŠÙ„Ø© (Ù†Ù…Ùˆ Ù…ÙƒÙ„Ù)</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ù†Ø²Ø§Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</label>
                <select id="mgmt" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="good">Ù…ÙˆØ«ÙˆÙ‚Ø©</option>
                    <option value="bad">Ø´Ø¨Ù‡Ø© ØªÙ„Ø§Ø¹Ø¨ / Ø§Ø³ØªÙ‚Ø§Ù„Ø§Øª</option>
                </select>
            </div>
        </div>
    </div>

    <!-- ===== Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ===== -->
    <div class="results-section pending" id="resultsSection">
        <div class="result-content">
            <div style="text-align:center;">
                <div class="score-display" id="totalScore">â€”</div>
                <div class="score-label">Ù…Ù† 100</div>
                <div id="evalBadge" class="evaluation-badge">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
            </div>
            <div class="chart-box">
                <canvas id="qualityChart"></canvas>
            </div>
        </div>
        <div class="analysis-box">
            <strong>ğŸ“‹ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ:</strong>
            <p id="analysisText" style="color:rgba(255,255,255,0.7);">
                Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...
            </p>
            <!-- âœ… flagMsg ÙŠÙØ³ØªØ®Ø¯Ù… Ø§Ù„Ø¢Ù† -->
            <span id="flagMsg" class="red-flag"></span>
        </div>
    </div>

</div><!-- end .container -->

<script>
    /* ===== Navbar ===== */
    function toggleNavbar() {
        document.getElementById('navbarMenu').classList.toggle('collapsed');
    }

    /* ===== Chart ===== */
    let qChart = null;

    function updateChart(score, color) {
        const ctx = document.getElementById('qualityChart').getContext('2d');
        if (qChart) { qChart.destroy(); qChart = null; }
        qChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [score, 100 - score],
                    backgroundColor: [color, 'rgba(255,255,255,0.08)'],
                    borderWidth: 0
                }]
            },
            options: {
                cutout: '80%',
                plugins: { tooltip: { enabled: false }, legend: { display: false } },
                animation: { duration: 600 }
            }
        });
    }

    /* ===== Throttle: Ù„Ø§ Ù†ÙØ¹ÙŠØ¯ Ø§Ù„Ø±Ø³Ù… Ø¹Ù†Ø¯ ÙƒÙ„ Ø¶ØºØ·Ø© ===== */
    let updateTimer = null;
    function scheduleUpdate() {
        clearTimeout(updateTimer);
        updateTimer = setTimeout(updateUI, 280);
    }

    /* ===== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===== */
    function isDataComplete() {
        const numericFields = ['growth', 'cashCycle', 'roe', 'debt'];
        const selectFields  = ['cashQuality', 'assetTurnover', 'moat', 'capex', 'mgmt'];
        for (const id of numericFields) {
            if (document.getElementById(id).value === '') return false;
        }
        for (const id of selectFields) {
            if (document.getElementById(id).value === '') return false;
        }
        return true;
    }

    /* ===== Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØµØ­Ø­ ===== */
    function calculateSmartScore() {
        const growth   = parseFloat(document.getElementById('growth').value)    || 0;
        const cycle    = parseFloat(document.getElementById('cashCycle').value) || 999;
        const cashQ    = document.getElementById('cashQuality').value;
        const roe      = parseFloat(document.getElementById('roe').value)       || 0;
        const turnover = document.getElementById('assetTurnover').value;
        const debt     = parseFloat(document.getElementById('debt').value)      || 0;
        const moat     = document.getElementById('moat').value;
        const capex    = document.getElementById('capex').value;
        const mgmt     = document.getElementById('mgmt').value;

        /*
         * Ø§Ù„Ø£ÙˆØ²Ø§Ù† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©:
         *  ROE/Debt      â†’ max 25
         *  Cash Quality  â†’ max 20
         *  Growth/CapEx  â†’ max 20
         *  Turnover      â†’ max 10
         *  Moat          â†’ max 15
         *  Mgmt          â†’ max 10
         *  Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ = 100 Ø¨Ø§Ù„Ø¶Ø¨Ø·
         */

        let score    = 0;
        let flags    = [];
        let analysis = [];

        /* ---- 1. Ø§Ù„Ø±Ø¨Ø­ÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ© (ROE + Debt) â€” max 25 ---- */
        if (roe >= 15 && debt <= 30) {
            score += 25;
            analysis.push("âœ… Ø¹ÙˆØ§Ø¦Ø¯ Ø¹Ø§Ù„ÙŠØ© Ø¯ÙˆÙ† Ø§Ø¹ØªÙ…Ø§Ø¯ Ù…ÙØ±Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙŠÙˆÙ†.");
        } else if (roe >= 15 && debt > 50) {
            score += 10;
            analysis.push("âš ï¸ ROE Ù…Ø±ØªÙØ¹ Ù„ÙƒÙ†Ù‡ Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø±Ø§ÙØ¹Ø© Ù…Ø§Ù„ÙŠØ© Ø¹Ø§Ù„ÙŠØ© â€” Ø®Ø·Ø± Ù…Ø®ÙÙŠ.");
        } else if (roe >= 8) {
            score += 12;
            analysis.push("â„¹ï¸ ÙƒÙØ§Ø¡Ø© Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ù…Ù‚Ø¨ÙˆÙ„Ø©ØŒ Ù„ÙƒÙ†Ù‡Ø§ Ø¯ÙˆÙ† Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©.");
        } else {
            score += 2;
            analysis.push("âŒ ÙƒÙØ§Ø¡Ø© Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø¶Ø¹ÙŠÙØ© Ø¬Ø¯Ø§Ù‹ (ROE < 8%).");
        }

        /* ---- 2. Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ â€” max 20 ---- */
        if (cashQ === 'high' && cycle <= 40) {
            score += 20;
            analysis.push("âœ… 'Ù…Ø§ÙƒÙŠÙ†Ø© ÙƒØ§Ø´': Ø£Ø±Ø¨Ø§Ø­ Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆØ¯ÙˆØ±Ø© ØªØ­ØµÙŠÙ„ Ø³Ø±ÙŠØ¹Ø©.");
        } else if (cashQ === 'low' && cycle <= 40) {
            score -= 10;
            flags.push("ğŸš¨ ØªÙ†Ø§Ù‚Ø¶ Ù…Ø­Ø§Ø³Ø¨ÙŠ: Ø¯ÙˆØ±Ø© ÙƒØ§Ø´ Ù‚ØµÙŠØ±Ø© Ù„ÙƒÙ† Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù„Ø§ ØªØªØ­ÙˆÙ„ Ù„Ø³ÙŠÙˆÙ„Ø©! â€” Ø§Ø­ØªÙ…Ø§Ù„ ØªÙ„Ø§Ø¹Ø¨.");
        } else if (cashQ === 'high' && cycle <= 80) {
            score += 12;
            analysis.push("âœ… Ø£Ø±Ø¨Ø§Ø­ Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ù„ÙƒÙ† Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„ ØªØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†Ø§Ù‹.");
        } else if (cashQ === 'high') {
            score += 6;
            analysis.push("âš ï¸ Ø£Ø±Ø¨Ø§Ø­ Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ù„ÙƒÙ† Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„ Ø·ÙˆÙŠÙ„Ø© Ø¬Ø¯Ø§Ù‹.");
        } else {
            flags.push("âš ï¸ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù„Ø§ ØªØªØ­ÙˆÙ„ Ù„ÙƒØ§Ø´ â€” Ø±Ø§Ø¬Ø¹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©.");
        }

        /* ---- 3. Ø§Ù„Ù†Ù…Ùˆ ÙˆØ§Ù„ÙƒÙØ§Ø¡Ø© â€” max 20 ---- */
        if (growth >= 15 && capex === 'light') {
            score += 20;
            analysis.push("âœ… Ù†Ù…Ùˆ Ù…Ø«Ø§Ù„ÙŠ Ø¯ÙˆÙ† ØªÙƒØ§Ù„ÙŠÙ Ø£ØµÙˆÙ„ Ø«Ù‚ÙŠÙ„Ø©.");
        } else if (growth >= 10 && capex === 'light') {
            score += 15;
            analysis.push("âœ… Ù†Ù…Ùˆ Ø¬ÙŠØ¯ Ø¨ÙƒÙØ§Ø¡Ø© Ø±Ø£Ø³ Ù…Ø§Ù„ÙŠØ©.");
        } else if (growth >= 10 && capex === 'heavy') {
            score += 8;
            analysis.push("â„¹ï¸ Ù†Ù…Ùˆ Ù…ÙƒÙ„Ù: Ø§Ù„Ø´Ø±ÙƒØ© ØªØ¶Ø·Ø± Ù„Ø¶Ø® Ø³ÙŠÙˆÙ„Ø© ÙƒØ¨ÙŠØ±Ø© Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©.");
        } else if (growth >= 0) {
            score += 4;
            analysis.push("âš ï¸ Ù†Ù…Ùˆ Ù…Ø­Ø¯ÙˆØ¯ â€” Ø±Ø§Ø¬Ø¹ Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©.");
        } else {
            score += 0;
            analysis.push("âŒ Ø£Ø±Ø¨Ø§Ø­ ÙÙŠ ØªØ±Ø§Ø¬Ø¹ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù‡ÙŠÙƒÙ„ÙŠØ©.");
        }

        /* ---- 4. Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø£ØµÙˆÙ„ â€” max 10 ---- */
        if (turnover === 'high')      { score += 10; }
        else if (turnover === 'mid')  { score += 5;  }
        else                          { score += 0; analysis.push("âš ï¸ Ø¯ÙˆØ±Ø§Ù† Ø£ØµÙˆÙ„ Ù…Ù†Ø®ÙØ¶ â€” Ø®Ù…ÙˆÙ„ ØªØ´ØºÙŠÙ„ÙŠ."); }

        /* ---- 5. Ø§Ù„Ø®Ù†Ø¯Ù‚ Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠ â€” max 15 ---- */
        if (moat === 'strong') {
            score += 15;
            analysis.push("âœ… Ù…ÙŠØ²Ø© ØªÙ†Ø§ÙØ³ÙŠØ© Ù‚ÙˆÙŠØ© ØªØ­Ù…ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ù‰ Ø§Ù„Ø¨Ø¹ÙŠØ¯.");
        } else {
            analysis.push("âš ï¸ Ù„Ø§ Ù…ÙŠØ²Ø© ÙˆØ§Ø¶Ø­Ø© â€” Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ù‡Ø¯Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©.");
        }

        /* ---- 6. Ù†Ø²Ø§Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€” max 10 ---- */
        if (mgmt === 'good') {
            score += 10;
        } else {
            score -= 30; /* Ø¹Ù‚ÙˆØ¨Ø© ØµØ§Ø±Ù…Ø© â€” Ù„ÙŠØ³Øª -50 Ù„Ø£Ù† Ø§Ù„ÙˆØ²Ù† Ø§Ù„ÙƒÙ„ÙŠ 100 */
            flags.push("ğŸ›‘ Ø®Ø·Ø± Ø¥Ø¯Ø§Ø±ÙŠ Ø­Ø±Ø¬: Ø§Ù„Ù†Ø²Ø§Ù‡Ø© Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡Ø§. ÙŠÙÙØ¶ÙÙ‘Ù„ Ø§Ù„Ø§Ø¨ØªØ¹Ø§Ø¯ ØªÙ…Ø§Ù…Ø§Ù‹.");
        }

        return {
            total:    Math.max(0, Math.min(Math.round(score), 100)),
            analysis: analysis.join('<br>'),
            flags:    flags.join('<br>')
        };
    }

    /* ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ===== */
    function updateUI() {
        /* âœ… Ù„Ø§ ØªÙØ­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        if (!isDataComplete()) {
            document.getElementById('resultsSection').classList.add('pending');
            document.getElementById('totalScore').textContent    = 'â€”';
            document.getElementById('analysisText').innerHTML    = 'Ø£ÙƒÙ…Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù„Ø±Ø¤ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„.';
            document.getElementById('flagMsg').innerHTML         = '';
            document.getElementById('evalBadge').textContent     = 'Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
            document.getElementById('evalBadge').style.background = '#7f8c8d';
            return;
        }

        const result = calculateSmartScore();
        document.getElementById('resultsSection').classList.remove('pending');
        document.getElementById('totalScore').textContent = result.total;
        document.getElementById('analysisText').innerHTML = result.analysis ||
            '<span style="opacity:0.6">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©.</span>';
        document.getElementById('flagMsg').innerHTML = result.flags;

        const badge = document.getElementById('evalBadge');
        let color;

        if (result.total >= 80) {
            badge.textContent     = "ğŸŒŸ Ø¬ÙˆØ¯Ø© Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©";
            badge.style.background = "#27ae60"; color = '#2ecc71';
        } else if (result.total >= 65) {
            badge.textContent     = "âœ… Ø´Ø±ÙƒØ© Ø¬ÙŠØ¯Ø©";
            badge.style.background = "#2980b9"; color = '#3498db';
        } else if (result.total >= 45) {
            badge.textContent     = "âš ï¸ Ø¬ÙˆØ¯Ø© Ù…ØªÙˆØ³Ø·Ø©";
            badge.style.background = "#f39c12"; color = '#f39c12';
        } else {
            badge.textContent     = "ğŸš¨ Ù…Ø®Ø§Ø·Ø± Ø¹Ø§Ù„ÙŠØ©";
            badge.style.background = "#c0392b"; color = '#e74c3c';
        }

        updateChart(result.total, color);
    }
</script>
</body>
</html>
