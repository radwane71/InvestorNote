<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ‚ÙŠÙŠÙ… Ø¬ÙˆØ¯Ø© Ø§Ù„Ø´Ø±ÙƒØ© | Ù…ÙÙƒØ±Ø© Ù…Ø³ØªØ«Ù…Ø±</title>
    <link rel="stylesheet" href="navigation.css">
    <link rel="stylesheet" href="dark-theme.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" defer></script>
    <style>
        .legal-banner {
            background: linear-gradient(135deg, #1a1400 0%, #2a1f00 60%, #1a1000) !important;
            border: 2px solid var(--gold) !important;
            border-radius: var(--radius-sm) !important;
            padding: 14px 18px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            box-shadow: var(--shadow-glow-gold), inset 0 0 30px rgba(245,158,11,0.04);
        }
        .legal-banner span:first-child { font-size: 1.3rem; flex-shrink: 0; }
        .legal-banner p { color: #fde68a !important; font-weight: bold; font-size: 0.88rem; line-height: 1.5; flex: 1; }

        h1 { text-align: center; color: var(--text-h) !important; margin-bottom: 8px; font-size: 2rem; }
        p.subtitle { text-align: center; color: var(--text-muted) !important; margin-bottom: 30px; }

        .rule-item {
            background: var(--bg-card2) !important;
            border-radius: var(--radius) !important;
            padding: 25px;
            margin: 20px 0;
            border-right: 4px solid var(--blue) !important;
            box-shadow: var(--shadow-card) !important;
            transition: var(--transition);
        }
        .rule-item:hover {
            border-right-color: var(--blue-light) !important;
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow-b) !important;
        }
        .rule-item h3 { color: var(--blue-light) !important; margin-bottom: 20px; border-bottom: 1px solid var(--border); padding-bottom: 10px; font-size: 1.1rem; }

        .input-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
        .input-group label { display: block; font-weight: 600; margin-bottom: 7px; font-size: 0.9rem; color: var(--text-body) !important; }
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border) !important;
            border-radius: var(--radius-xs) !important;
            font-size: 0.95rem;
            background: var(--bg-input) !important;
            color: var(--text-h) !important;
        }

        .results-section {
            background: var(--bg-card) !important;
            border: 1px solid var(--border) !important;
            border-radius: 20px !important;
            padding: 40px;
            margin-top: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3) !important;
        }
        .results-section.pending { display: none; }

        .result-main-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255,255,255,0.03);
            border-radius: 20px;
        }

        .score-box { text-align: center; }
        .score-circle-text {
            font-size: 5.5rem;
            font-weight: 900;
            /* âš ï¸ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ø¨Øª â€” ÙŠØªØ­ÙƒÙ… ÙÙŠÙ‡ JavaScript */
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            transition: all 0.4s ease;
        }

        .evaluation-label {
            font-size: 1.4rem;
            font-weight: 800;
            margin-top: 10px;
            padding: 8px 25px;
            border-radius: 50px;
            display: inline-block;
        }

        /* âœ… Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .score-bar-wrapper {
            margin-top: 15px;
            background: rgba(255,255,255,0.08);
            border-radius: 50px;
            height: 10px;
            width: 200px;
            overflow: hidden;
        }
        .score-bar-fill {
            height: 100%;
            border-radius: 50px;
            transition: width 0.8s ease, background 0.4s ease;
        }

        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin-bottom: 35px;
        }
        .ind-card {
            background: var(--bg-card2);
            padding: 18px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid var(--border);
            transition: 0.3s;
        }
        .ind-card:hover { border-color: var(--gold); transform: translateY(-3px); }
        .ind-card .ind-icon { font-size: 1.8rem; margin-bottom: 8px; display: block; }
        /* âœ… Ø§Ù„Ù„ÙˆÙ† ÙŠØ£ØªÙŠ Ù…Ù† JS Ø¹Ø¨Ø± style inline */
        .ind-card .ind-val { font-size: 1.1rem; font-weight: bold; }
        .ind-card .ind-lbl { font-size: 0.78rem; color: var(--text-muted); display: block; margin-top: 5px; }
        /* âœ… Ø´Ø±ÙŠØ· ØµØºÙŠØ± ØªØ­Øª ÙƒÙ„ ÙƒØ§Ø±Ø¯ */
        .ind-card .ind-bar {
            margin-top: 8px;
            height: 4px;
            border-radius: 50px;
            opacity: 0.7;
        }

        .analysis-container {
            background: rgba(59, 130, 246, 0.05);
            border-right: 5px solid var(--blue);
            padding: 25px;
            border-radius: 12px;
        }
        .analysis-container h4 { color: var(--blue-light); margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .analysis-list { list-style: none; padding: 0; }
        .analysis-list li {
            position: relative;
            padding-right: 25px;
            margin-bottom: 12px;
            color: var(--text-body);
            line-height: 1.6;
            font-size: 0.95rem;
        }
        .analysis-list li::before { content: "â€¢"; position: absolute; right: 0; color: var(--gold); font-weight: bold; font-size: 1.5rem; line-height: 1; }

        .red-flag-zone {
            margin-top: 25px;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--red-light);
            padding: 20px;
            border-radius: 12px;
            color: var(--red-light);
        }
        .red-flag-zone h5 { font-weight: 800; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }

        /* âœ… Ù‚Ø³Ù… Ø´Ø±Ø­ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª */
        .score-guide {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        .score-guide-item {
            font-size: 0.8rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .score-guide-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .result-main-info { flex-direction: column; }
            .score-circle-text { font-size: 4rem; }
        }
    </style>
</head>
<body>

<nav class="navbar">
    <div class="navbar-container">
        <a href="index.html" class="navbar-brand">ğŸ“ˆ Ù…ÙÙƒØ±Ø© Ù…Ø³ØªØ«Ù…Ø±</a>
        <button class="navbar-toggle" onclick="toggleNavbar()">â˜°</button>
        <div class="navbar-menu" id="navbarMenu">
            <a href="index.html" class="navbar-item">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <a href="advice.html" class="navbar-item calculator">ğŸ’° ØµØ§ÙÙŠ Ø§Ù„Ø«Ø±ÙˆØ©</a>
            <a href="salary_calculator.html" class="navbar-item salary">ğŸ’¼ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø±Ø§ØªØ¨</a>
            <a href="zakat_purification.html" class="navbar-item zakat">ğŸ•Œ Ø§Ù„Ø²ÙƒØ§Ø©</a>
            <a href="financial_freedom.html" class="navbar-item fire">ğŸ”¥ Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</a>
            <a href="investor_tips.html" class="navbar-item tips">âš ï¸ Ù†ØµØ§Ø¦Ø­</a>
            <a href="snowball_calculator.html" class="navbar-item calculator">â„ï¸ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ù…Ø±ÙƒØ¨</a>
            <a href="emergency_fund_calculator.html" class="navbar-item emergency">ğŸ›¡ï¸ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</a>
            <a href="average_calculator.html" class="navbar-item average">ğŸ“Š Ù…ØªÙˆØ³Ø· Ø§Ù„Ø´Ø±Ø§Ø¡</a>
            <a href="company_valuation.html" class="navbar-item company active">ğŸ¢ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø´Ø±ÙƒØ©</a>
            <a href="retirement_calculator.html" class="navbar-item retirement">ğŸ–ï¸ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯</a>
            <a href="portfolio_rating.html" class="navbar-item portfolio">ğŸ›¡ï¸ Ø£Ù…Ø§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©</a>
            <a href="stock_valuation.html" class="navbar-item calculator">ğŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø³Ù‡Ù…</a>
            <a href="dca_calculator.html" class="navbar-item calculator">ğŸ“… DCA</a>
            <a href="sell_decision.html" class="navbar-item calculator">ğŸ¤” Ù‡Ù„ Ø£Ø¨ÙŠØ¹ØŸ</a>
            <a href="goal_calculator.html" class="navbar-item calculator">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¹ÙƒØ³ÙŠ</a>
            <a href="allocation_calculator.html" class="navbar-item allocation">âš–ï¸ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ÙØ¸Ø©</a>
        </div>
    </div>
</nav>

<div class="container">
    <div class="legal-banner">
        <span>âš ï¸</span>
        <p>Ø¥Ù‚Ø±Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÙŠ: Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© ØªÙ‚Ø¯ÙŠØ±ÙŠØ©. Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ø§ ØªÙÙ…Ø«Ù‘Ù„ Ø§Ø³ØªØ´Ø§Ø±Ø© Ù…Ø§Ù„ÙŠØ© Ù…Ù„Ø²Ù…Ø©. Ù‚Ø±Ø§Ø± Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙŠÙ‚Ø¹ Ø¹Ù„Ù‰ Ø¹Ø§ØªÙ‚ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….</p>
    </div>

    <h1>ğŸ¢ Ù…Ø­Ù„Ù„ Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø°ÙƒÙŠ</h1>
    <p class="subtitle">ØªÙ‚ÙŠÙŠÙ… Ø´Ø§Ù…Ù„ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù†Ù…Ùˆ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</p>

    <!-- Ø´Ø±Ø­ Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª -->
    <div class="score-guide">
        <div class="score-guide-item"><div class="score-guide-dot" style="background:#10b981"></div>80-100 Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©</div>
        <div class="score-guide-item"><div class="score-guide-dot" style="background:#3b82f6"></div>60-79 Ø¬ÙŠØ¯Ø©</div>
        <div class="score-guide-item"><div class="score-guide-dot" style="background:#f59e0b"></div>40-59 Ù…ØªÙˆØ³Ø·Ø©</div>
        <div class="score-guide-item"><div class="score-guide-dot" style="background:#ef4444"></div>0-39 Ù…Ø®Ø§Ø·Ø± Ø¹Ø§Ù„ÙŠØ©</div>
    </div>

    <br>

    <div class="rule-item">
        <h3>1ï¸âƒ£ Ø§Ù„ÙƒÙØ§Ø¡Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ© ÙˆØ¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</h3>
        <div class="input-grid">
            <div class="input-group">
                <label>Ù†Ù…Ùˆ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)</label>
                <input type="number" id="growth" placeholder="Ù…Ø«Ø§Ù„: 15" oninput="scheduleUpdate()">
            </div>
            <div class="input-group">
                <label>Ø¯ÙˆØ±Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒØ§Ø´ (Ø£ÙŠØ§Ù…)</label>
                <input type="number" id="cashCycle" placeholder="Ù…Ø«Ø§Ù„: 35" oninput="scheduleUpdate()">
            </div>
            <div class="input-group">
                <label>Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ (Ø§Ù„ÙƒØ§Ø´)</label>
                <select id="cashQuality" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="high">ÙƒØ§Ø´ Ø§Ù„ØªØ´ØºÙŠÙ„ > ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ âœ…</option>
                    <option value="low">ÙƒØ§Ø´ Ø§Ù„ØªØ´ØºÙŠÙ„ < ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ âš ï¸</option>
                </select>
            </div>
        </div>
    </div>

    <div class="rule-item">
        <h3>2ï¸âƒ£ Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…ÙŠØ²Ø©</h3>
        <div class="input-grid">
            <div class="input-group">
                <label>Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù‚ÙˆÙ‚ ROE (%)</label>
                <input type="number" id="roe" placeholder="Ù…Ø«Ø§Ù„: 18" oninput="scheduleUpdate()">
            </div>
            <div class="input-group">
                <label>Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø£ØµÙˆÙ„</label>
                <select id="assetTurnover" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="high">Ù…Ø±ØªÙØ¹ (ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ©)</option>
                    <option value="mid">Ù…ØªÙˆØ³Ø·</option>
                    <option value="low">Ù…Ù†Ø®ÙØ¶</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¯ÙŠÙˆÙ† (%)</label>
                <input type="number" id="debt" placeholder="Ù…Ø«Ø§Ù„: 30" oninput="scheduleUpdate()">
            </div>
        </div>
    </div>

    <div class="rule-item">
        <h3>3ï¸âƒ£ Ø§Ù„Ù†ÙˆØ¹ÙŠØ© ÙˆØ§Ù„Ù†Ø²Ø§Ù‡Ø©</h3>
        <div class="input-grid">
            <div class="input-group">
                <label>Ø®Ù†Ø¯Ù‚ ØªÙ†Ø§ÙØ³ÙŠ (Moat)</label>
                <select id="moat" onchange="scheduleUpdate()">
                    <option value="">â€” Ø§Ø®ØªØ± â€”</option>
                    <option value="strong">Ù‚ÙˆÙŠ Ø¬Ø¯Ø§Ù‹ ğŸ°</option>
                    <option value="none">Ø¶Ø¹ÙŠÙ / Ù„Ø§ ÙŠÙˆØ¬Ø¯</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ (CapEx)</label>
                <select id="capex" onchange="scheduleUpdate()">
                    <option value="light">Ø£ØµÙˆÙ„ Ø®ÙÙŠÙØ© (Ù…Ù…ØªØ§Ø²) âœ…</option>
                    <option value="heavy">Ø£ØµÙˆÙ„ Ø«Ù‚ÙŠÙ„Ø© âš ï¸</option>
                </select>
            </div>
            <div class="input-group">
                <label>Ù†Ø²Ø§Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</label>
                <select id="mgmt" onchange="scheduleUpdate()">
                    <option value="good">Ù…ÙˆØ«ÙˆÙ‚Ø© âœ…</option>
                    <option value="bad">Ø´Ø¨Ù‡Ø§Øª / ØªÙ„Ø§Ø¹Ø¨ ğŸš¨</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
    <div class="results-section pending" id="resultsSection">

        <div class="result-main-info">
            <div class="score-box">
                <div class="score-circle-text" id="totalScore">0</div>
                <div style="color: var(--text-muted); font-weight: bold; font-size:0.9rem; margin-top:5px;">Ù†Ù‚Ø§Ø· Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© / 100</div>
                <div id="evalBadge" class="evaluation-label" style="margin-top:10px;">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
                <!-- âœ… Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
                <div class="score-bar-wrapper" style="margin: 12px auto 0;">
                    <div class="score-bar-fill" id="scoreBarFill" style="width:0%; background:#f59e0b;"></div>
                </div>
            </div>
            <div class="chart-box" style="width: 220px; height: 220px;">
                <canvas id="qualityChart"></canvas>
            </div>
        </div>

        <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª -->
        <div class="indicators-grid" id="indicatorsGrid"></div>

        <!-- Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØµÙŠ -->
        <div class="analysis-container">
            <h4>ğŸ” Ù…Ù„Ø®Øµ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ:</h4>
            <ul class="analysis-list" id="analysisText"></ul>
        </div>

        <!-- Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ -->
        <div id="redFlagContainer" class="red-flag-zone" style="display:none;">
            <h5>ğŸ›‘ ØªØ­Ø°ÙŠØ±Ø§Øª Ø­Ø±Ø¬Ø© (Red Flags):</h5>
            <div id="flagMsg"></div>
        </div>

    </div>
</div>

<script>
let qChart = null;
let updateTimer = null;

function toggleNavbar() {
    document.getElementById('navbarMenu').classList.toggle('open');
}

function scheduleUpdate() {
    clearTimeout(updateTimer);
    updateTimer = setTimeout(updateUI, 300);
}

// âœ… Ø¥ØµÙ„Ø§Ø­: Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ù†Ø¯ Ù…Ø³Ø­ Ø£ÙŠ Ø­Ù‚Ù„
function isDataComplete() {
    const ids = ['growth', 'cashCycle', 'roe', 'debt', 'cashQuality', 'assetTurnover', 'moat', 'mgmt'];
    return ids.every(id => document.getElementById(id).value !== "");
}

function updateChart(score, color) {
    const ctx = document.getElementById('qualityChart').getContext('2d');
    if (qChart) qChart.destroy();
    qChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            datasets: [{
                data: [score, 100 - score],
                backgroundColor: [color, 'rgba(255,255,255,0.05)'],
                borderWidth: 0
            }]
        },
        options: {
            cutout: '85%',
            plugins: { tooltip: { enabled: false }, legend: { display: false } },
            animation: { duration: 600 }
        }
    });
}

function updateUI() {
    const section = document.getElementById('resultsSection');

    // âœ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¥Ø°Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©
    if (!isDataComplete()) {
        section.classList.add('pending');
        return;
    }

    const res = calculateSmartScore();
    section.classList.remove('pending');

    // âœ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù‚Ù… Ù…Ø¹ Ù„ÙˆÙ†Ù‡ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
    const scoreEl = document.getElementById('totalScore');
    scoreEl.textContent = res.total;

    let color, badgeText, badgeColor;
    if (res.total >= 80) {
        color = '#10b981';
        badgeText = 'ğŸŒŸ Ø´Ø±ÙƒØ© Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©';
        badgeColor = '#10b981';
        scoreEl.style.backgroundImage = 'linear-gradient(135deg, #10b981, #34d399)';
    } else if (res.total >= 60) {
        color = '#3b82f6';
        badgeText = 'âœ… Ø´Ø±ÙƒØ© Ø¬ÙŠØ¯Ø©';
        badgeColor = '#3b82f6';
        scoreEl.style.backgroundImage = 'linear-gradient(135deg, #3b82f6, #60a5fa)';
    } else if (res.total >= 40) {
        color = '#f59e0b';
        badgeText = 'âš ï¸ Ø´Ø±ÙƒØ© Ù…ØªÙˆØ³Ø·Ø©';
        badgeColor = '#f59e0b';
        scoreEl.style.backgroundImage = 'linear-gradient(135deg, #f59e0b, #fbbf24)';
    } else {
        color = '#ef4444';
        badgeText = 'ğŸš¨ Ù…Ø®Ø§Ø·Ø± Ø¹Ø§Ù„ÙŠØ©';
        badgeColor = '#ef4444';
        scoreEl.style.backgroundImage = 'linear-gradient(135deg, #ef4444, #f87171)';
    }

    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø®Ø§ØµÙŠØ© background-clip Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù€ background
    scoreEl.style.webkitBackgroundClip = 'text';
    scoreEl.style.backgroundClip = 'text';
    scoreEl.style.webkitTextFillColor = 'transparent';

    const badge = document.getElementById('evalBadge');
    badge.textContent = badgeText;
    badge.style.color = badgeColor;

    // âœ… ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
    const bar = document.getElementById('scoreBarFill');
    bar.style.width = res.total + '%';
    bar.style.background = color;

    updateChart(res.total, color);

    // âœ… Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ù…Ø¹ Ø£Ù„ÙˆØ§Ù† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
    const indGrid = document.getElementById('indicatorsGrid');
    indGrid.innerHTML = res.indicators.map(i => `
        <div class="ind-card">
            <span class="ind-icon">${i.icon}</span>
            <span class="ind-val" style="color:${i.color}">${i.val}</span>
            <span class="ind-lbl">${i.label}</span>
            <div class="ind-bar" style="background:${i.color}; width:100%;"></div>
        </div>
    `).join('');

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ­Ù„ÙŠÙ„
    document.getElementById('analysisText').innerHTML =
        res.analysis.map(a => `<li>${a}</li>`).join('');

    // Ø§Ù„Ø£Ø¹Ù„Ø§Ù… Ø§Ù„Ø­Ù…Ø±Ø§Ø¡
    const flagContainer = document.getElementById('redFlagContainer');
    if (res.flags.length > 0) {
        flagContainer.style.display = 'block';
        document.getElementById('flagMsg').innerHTML =
            res.flags.map(f => `<div style="margin-bottom:6px;">ğŸš© ${f}</div>`).join('');
    } else {
        flagContainer.style.display = 'none';
    }
}

// ========================================================
// âœ… Ø¯Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© ÙƒÙ„ÙŠØ§Ù‹
// ========================================================
function calculateSmartScore() {
    const g    = parseFloat(document.getElementById('growth').value);
    const c    = parseFloat(document.getElementById('cashCycle').value);
    const roe  = parseFloat(document.getElementById('roe').value);
    const d    = parseFloat(document.getElementById('debt').value);
    const q    = document.getElementById('cashQuality').value;
    const m    = document.getElementById('moat').value;
    const mg   = document.getElementById('mgmt').value;
    const t    = document.getElementById('assetTurnover').value;
    const capex = document.getElementById('capex').value; // âœ… Ù…ÙÙØ¹ÙÙ‘Ù„ Ø§Ù„Ø¢Ù†

    let score = 0;
    let analysis = [];
    let flags = [];

    // === Block 1: ROE + Ø§Ù„Ø¯ÙŠÙˆÙ† (max 25) ===
    // âœ… 3 ØªØ¯Ø±Ø¬Ø§Øª Ø¨Ø¯Ù„ ØªØ¯Ø±Ø¬ÙŠÙ†
    if (roe >= 15) {
        if (d <= 30) {
            score += 25;
            analysis.push("ROE Ù…Ù…ØªØ§Ø² (â‰¥15%) Ù…Ø¹ Ø¯ÙŠÙˆÙ† Ù…Ù†Ø®ÙØ¶Ø© â€” ÙƒÙØ§Ø¡Ø© Ø±Ø£Ø³ Ù…Ø§Ù„ Ø­Ù‚ÙŠÙ‚ÙŠØ©.");
        } else if (d <= 60) {
            score += 15;
            analysis.push("ROE Ø¬ÙŠØ¯ Ù„ÙƒÙ† Ø§Ù„Ø¯ÙŠÙˆÙ† Ù…ØªÙˆØ³Ø·Ø© â€” Ø±Ø§Ù‚Ø¨ Ù†Ø³Ø¨Ø© ØªØºØ·ÙŠØ© Ø§Ù„ÙÙˆØ§Ø¦Ø¯.");
            flags.push("Ø§Ù„Ø¯ÙŠÙˆÙ† ØªØªØ¬Ø§ÙˆØ² 30%: ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚Ø¯Ø±Ø© Ø§Ù„Ø´Ø±ÙƒØ© Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¯ÙŠÙ†.");
        } else {
            score += 5;
            analysis.push("ROE Ù…Ø±ØªÙØ¹ Ù„ÙƒÙ†Ù‡ Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø¯ÙŠÙˆÙ† Ø®Ø·ÙŠØ±Ø© â€” Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù…Ø¶Ù„Ù„Ø§Ù‹.");
            flags.push("Ø¯ÙŠÙˆÙ† ØªØªØ¬Ø§ÙˆØ² 60% Ù…Ø¹ ROE Ù…Ø±ØªÙØ¹: Ø§Ù„Ø±Ø§ÙØ¹Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ØªÙØ¶Ø®Ù‘Ù… Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§ØµØ·Ù†Ø§Ø¹ÙŠØ§Ù‹.");
        }
    } else if (roe >= 10) {
        score += 10;
        analysis.push("ROE Ù…ØªÙˆØ³Ø· (10â€“14%) â€” Ù‚Ø§Ø±Ù† Ø¨Ù…ØªÙˆØ³Ø· Ø§Ù„Ù‚Ø·Ø§Ø¹ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙƒÙ….");
    } else {
        score += 0;
        flags.push("ROE Ø£Ù‚Ù„ Ù…Ù† 10%: Ø§Ù„Ø´Ø±ÙƒØ© Ù„Ø§ ØªÙØ­Ù‚Ù‚ Ø¹Ø§Ø¦Ø¯Ø§Ù‹ ÙƒØ§ÙÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„.");
        analysis.push("Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ† Ø¶Ø¹ÙŠÙ â€” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ.");
    }

    // === Block 2: Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒØ§Ø´ + Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„ (max 20) ===
    // âœ… Ø¥ØµÙ„Ø§Ø­: Ø¯ÙˆØ±Ø© Ø§Ù„ÙƒØ§Ø´ Ù„Ù‡Ø§ ÙˆØ²Ù† Ù…Ø³ØªÙ‚Ù„ Ø§Ù„Ø¢Ù†
    if (q === 'high') {
        if (c <= 30) {
            score += 20;
            analysis.push("Ø¬ÙˆØ¯Ø© Ø£Ø±Ø¨Ø§Ø­ Ø¹Ø§Ù„ÙŠØ© ÙˆØ¯ÙˆØ±Ø© ØªØ­ØµÙŠÙ„ Ø³Ø±ÙŠØ¹Ø© Ø¬Ø¯Ø§Ù‹ â€” Cash Cow Ø­Ù‚ÙŠÙ‚ÙŠØ©.");
        } else if (c <= 60) {
            score += 12;
            analysis.push("Ø¬ÙˆØ¯Ø© ÙƒØ§Ø´ Ø¬ÙŠØ¯Ø©ØŒ Ù„ÙƒÙ† Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„ (31â€“60 ÙŠÙˆÙ…) ØªØ­ØªØ§Ø¬ Ù…Ø±Ø§Ù‚Ø¨Ø©.");
        } else {
            score += 5;
            analysis.push("Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ù†Ù‚Ø¯ÙŠØ© Ù„ÙƒÙ† Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„ Ø¨Ø·ÙŠØ¦Ø© â€” Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ù‚Ø¯ ØªÙƒÙˆÙ† Ù…Ù‚ÙŠØ¯Ø© Ù…Ø¤Ù‚ØªØ§Ù‹.");
            flags.push("Ø¯ÙˆØ±Ø© Ø§Ù„ØªØ­ØµÙŠÙ„ ØªØªØ¬Ø§ÙˆØ² 60 ÙŠÙˆÙ…Ø§Ù‹ Ø±ØºÙ… Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒØ§Ø´ â€” Ø±Ø§Ø¬Ø¹ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†.");
        }
    } else {
        score -= 10;
        flags.push("ØªØ­Ø°ÙŠØ±: Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠØ© Ù„Ø§ ØªØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ Ø³ÙŠÙˆÙ„Ø© Ù†Ù‚Ø¯ÙŠØ© â€” Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù…ÙŠÙ‚Ø© Ø¶Ø±ÙˆØ±ÙŠØ©.");
        analysis.push("ÙØ¬ÙˆØ© Ø¨ÙŠÙ† Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠ ÙˆØ§Ù„ÙƒØ§Ø´ Ø§Ù„ÙØ¹Ù„ÙŠ â€” Ø¹Ù„Ø§Ù…Ø© ØªØ³ØªØ­Ù‚ Ø§Ù„ØªÙ…Ø­ÙŠØµ.");
    }

    // === Block 3: Ø§Ù„Ù†Ù…Ùˆ (max 15) ===
    if (g >= 15) {
        score += 15;
        analysis.push("Ù†Ù…Ùˆ Ù‚ÙˆÙŠ (â‰¥15%) ÙŠØªØ¬Ø§ÙˆØ² Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³ÙˆÙ‚ â€” Ø¯Ù„ÙŠÙ„ Ø¹Ù„Ù‰ Ù…ÙŠØ²Ø© ØªÙ†Ø§ÙØ³ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ©.");
    } else if (g >= 8) {
        score += 8;
        analysis.push("Ù†Ù…Ùˆ Ù…Ø¹Ù‚ÙˆÙ„ (8â€“14%) â€” Ù…Ø³ØªØ¯Ø§Ù… Ù„ÙƒÙ† Ù„Ø§ ÙŠÙØ¨Ø±Ø± Ø¹Ù„Ø§ÙˆØ© Ø³Ø¹Ø±ÙŠØ© ÙƒØ¨ÙŠØ±Ø©.");
    } else if (g >= 0) {
        score += 2;
        analysis.push("Ù†Ù…Ùˆ Ø¶Ø¹ÙŠÙ (<8%) â€” Ø§Ù„Ø´Ø±ÙƒØ© ØªØ¹Ù…Ù„ Ù„ÙƒÙ† Ø¨Ù„Ø§ Ø²Ø®Ù… Ø­Ù‚ÙŠÙ‚ÙŠ.");
    } else {
        score -= 5;
        flags.push("ØªØ±Ø§Ø¬Ø¹ ÙÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ØªØ­Ù‚Ù‚ Ù…Ù† Ø·Ø¨ÙŠØ¹ØªÙ‡ (Ø¯ÙˆØ±ÙŠ Ø£Ù… Ù‡ÙŠÙƒÙ„ÙŠ) Ù‚Ø¨Ù„ Ø£ÙŠ Ù‚Ø±Ø§Ø±.");
        analysis.push("Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙÙŠ ØªØ±Ø§Ø¬Ø¹ â€” Ù„ÙŠØ³ ÙƒÙ„ Ø§Ù†Ø®ÙØ§Ø¶ Ø®Ø·Ø±ØŒ Ù„ÙƒÙ†Ù‡ ÙŠØ³ØªÙˆØ¬Ø¨ Ø§Ù„Ø³Ø¤Ø§Ù„.");
    }

    // === Block 4: Ø§Ù„Ø®Ù†Ø¯Ù‚ Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠ (max 15) ===
    if (m === 'strong') {
        score += 15;
        analysis.push("Ø§Ù„Ø®Ù†Ø¯Ù‚ Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠ ÙŠØ­Ù…ÙŠ Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ù‰ Ø§Ù„Ø¨Ø¹ÙŠØ¯.");
    } else {
        analysis.push("ØºÙŠØ§Ø¨ Ø§Ù„Ø®Ù†Ø¯Ù‚ ÙŠØ¹Ø±Ù‘Ø¶ Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ Ù„Ù„Ø¶ØºØ· Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ.");
    }

    // === Block 5: CapEx âœ… Ù…ÙÙØ¹ÙÙ‘Ù„ Ø§Ù„Ø¢Ù† (max 8) ===
    if (capex === 'light') {
        score += 8;
        analysis.push("Ø£ØµÙˆÙ„ Ø®ÙÙŠÙØ© = ØªØ¯ÙÙ‚ Ù†Ù‚Ø¯ÙŠ Ø­Ø± Ù…Ø±ØªÙØ¹ ÙˆÙ‚Ø¯Ø±Ø© ØªÙˆØ²ÙŠØ¹ Ø£ÙØ¶Ù„ Ù„Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†.");
    } else {
        score -= 3;
        analysis.push("Ø£ØµÙˆÙ„ Ø«Ù‚ÙŠÙ„Ø© ØªØ³ØªÙ†Ø²Ù Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ø§Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù†Ù‚Ø¯ÙŠ Ù„Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„ØªÙˆØ³Ø¹.");
    }

    // === Block 6: Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø£ØµÙˆÙ„ âœ… Ù…ÙÙØ¹ÙÙ‘Ù„ Ø§Ù„Ø¢Ù† (max 7) ===
    if (t === 'high') {
        score += 7;
        analysis.push("Ø¯ÙˆØ±Ø§Ù† Ø£ØµÙˆÙ„ Ù…Ø±ØªÙØ¹ â€” Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ³ØªØ®Ø¯Ù… Ø£ØµÙˆÙ„Ù‡Ø§ Ø¨ÙƒÙØ§Ø¡Ø© ØªØ´ØºÙŠÙ„ÙŠØ©.");
    } else if (t === 'mid') {
        score += 3;
        analysis.push("Ø¯ÙˆØ±Ø§Ù† Ø£ØµÙˆÙ„ Ù…ØªÙˆØ³Ø· â€” Ù‡Ù†Ø§Ùƒ Ù…Ø¬Ø§Ù„ Ù„Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠ.");
    } else {
        analysis.push("Ø¯ÙˆØ±Ø§Ù† Ø£ØµÙˆÙ„ Ù…Ù†Ø®ÙØ¶ â€” Ø§Ù„Ø£ØµÙˆÙ„ Ù„Ø§ ØªÙÙ†ØªØ¬ Ù‚ÙŠÙ…Ø© ÙƒØ§ÙÙŠØ© Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø­Ø¬Ù…Ù‡Ø§.");
    }

    // === Block 7: Ù†Ø²Ø§Ù‡Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø¹Ù‚ÙˆØ¨Ø© Ù†ÙˆÙˆÙŠØ©) ===
    if (mg === 'bad') {
        score -= 40;
        flags.push("Ø®Ø·Ø± Ø¥Ø¯Ø§Ø±ÙŠ Ø­Ø±Ø¬: ØºÙŠØ§Ø¨ Ø§Ù„Ù†Ø²Ø§Ù‡Ø© ÙŠÙØ¨Ø·Ù„ ÙƒÙ„ Ù…Ø¤Ø´Ø± Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ø¢Ø®Ø± â€” Ø§Ø¨ØªØ¹Ø¯.");
    }

    // âœ… Ø®Ø· Ø£Ø³Ø§Ø³ 10 Ù†Ù‚Ø§Ø· (floor Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ØªÙŠ Ù„Ù… ØªØ®Ø³Ø± Ù†Ù‚Ø§Ø·Ø§Ù‹)
    const total = Math.max(0, Math.min(score + 10, 100));

    // âœ… Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø¨Ø£Ù„ÙˆØ§Ù† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¬ÙˆØ¯Ø©
    return {
        total,
        analysis,
        flags,
        indicators: [
            {
                icon: g >= 15 ? 'ğŸš€' : g >= 8 ? 'ğŸ“ˆ' : g >= 0 ? 'ğŸ“‰' : 'ğŸ”»',
                val: g + '%',
                label: 'Ù†Ù…Ùˆ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­',
                color: g >= 15 ? '#10b981' : g >= 8 ? '#f59e0b' : '#ef4444'
            },
            {
                icon: d <= 30 ? 'ğŸŸ¢' : d <= 60 ? 'ğŸŸ¡' : 'ğŸ”´',
                val: d + '%',
                label: 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†',
                color: d <= 30 ? '#10b981' : d <= 60 ? '#f59e0b' : '#ef4444'
            },
            {
                icon: roe >= 15 ? 'ğŸ’' : roe >= 10 ? 'âœ…' : 'âš ï¸',
                val: roe + '%',
                label: 'ROE',
                color: roe >= 15 ? '#10b981' : roe >= 10 ? '#f59e0b' : '#ef4444'
            },
            {
                icon: c <= 30 ? 'âš¡' : c <= 60 ? 'ğŸ”„' : 'ğŸ¢',
                val: c + ' ÙŠÙˆÙ…',
                label: 'Ø¯ÙˆØ±Ø© Ø§Ù„ÙƒØ§Ø´',
                color: c <= 30 ? '#10b981' : c <= 60 ? '#f59e0b' : '#ef4444'
            },
            {
                icon: q === 'high' ? 'ğŸ’°' : 'âš ï¸',
                val: q === 'high' ? 'Ø­Ù‚ÙŠÙ‚ÙŠØ©' : 'ÙˆØ±Ù‚ÙŠØ©',
                label: 'Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒØ§Ø´',
                color: q === 'high' ? '#10b981' : '#ef4444'
            },
            {
                icon: m === 'strong' ? 'ğŸ°' : 'ğŸš§',
                val: m === 'strong' ? 'Ù‚ÙˆÙŠ' : 'Ø¶Ø¹ÙŠÙ',
                label: 'Ø§Ù„Ø®Ù†Ø¯Ù‚ Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠ',
                color: m === 'strong' ? '#10b981' : '#f59e0b'
            }
        ]
    };
}
</script>

</body>
</html>
