<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© (FIRE) - Ù…ÙÙƒØ±Ø© Ù…Ø³ØªØ«Ù…Ø±</title>
    <link rel="stylesheet" href="navigation.css">
    <link rel="stylesheet" href="dark-theme.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        /* ===== Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© ===== */
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            margin-top: 20px; 
        }

        .header { 
            text-align: center; 
            margin-bottom: 30px; 
        }
        .header h1 { 
            font-size: 2.5rem; 
            margin-bottom: 10px; 
            color: var(--text-h) !important;
            text-shadow: 0 2px 8px rgba(0,0,0,0.5);
        }
        .header p {
            color: var(--text-muted) !important;
            font-size: 1.1rem;
        }

        .section-title { 
            font-size: 1.4rem; 
            color: var(--text-h) !important; 
            margin-bottom: 25px; 
            border-bottom: 2px solid var(--border); 
            padding-bottom: 12px; 
        }

        /* ===== Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ===== */
        .calculator-section, .results-section, .chart-container, .sensitivity-analysis { 
            background: var(--bg-card) !important;
            border: 1px solid var(--border) !important;
            border-radius: var(--radius) !important; 
            padding: 30px; 
            margin-bottom: 30px; 
            box-shadow: var(--shadow-card) !important;
        }

        /* ===== Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ===== */
        .input-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; 
        }
        .input-group { 
            background: var(--bg-card2) !important;
            padding: 20px; 
            border-radius: var(--radius-sm) !important; 
            border: 1px solid var(--border) !important;
            transition: var(--transition);
        }
        .input-group:hover {
            border-color: var(--blue) !important;
        }
        .input-group label { 
            display: block; 
            margin-bottom: 10px; 
            font-weight: 600; 
            color: var(--text-body) !important;
            font-size: 0.95rem;
        }
        .input-group input, .input-group select { 
            width: 100%; 
            padding: 14px; 
            border: 2px solid var(--border) !important;
            border-radius: var(--radius-xs) !important; 
            font-size: 1rem;
            background: var(--bg-input) !important;
            color: var(--text-h) !important;
            transition: var(--transition);
        }
        .input-group input:focus, .input-group select:focus { 
            outline: none; 
            border-color: var(--blue) !important;
            box-shadow: var(--shadow-glow-b) !important;
        }
        .input-group input::placeholder { 
            color: var(--text-muted) !important; 
        }

        /* ===== Ø²Ø± Ø§Ù„Ø­Ø³Ø§Ø¨ ===== */
        .calculate-btn { 
            width: 100%; 
            padding: 16px; 
            background: linear-gradient(135deg, var(--green), var(--teal)) !important;
            color: white !important;
            border: none; 
            border-radius: var(--radius-sm) !important; 
            font-size: 1.2rem; 
            cursor: pointer; 
            font-weight: bold;
            transition: var(--transition);
            box-shadow: var(--shadow-glow-g) !important;
            margin-top: 10px;
        }
        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16,185,129,0.4) !important;
        }

        /* ===== Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ===== */
        .results-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 20px; 
            margin-bottom: 25px;
        }
        .result-card { 
            padding: 25px; 
            border-radius: var(--radius) !important; 
            text-align: center;
            border: 1px solid var(--border) !important;
            transition: var(--transition);
        }
        .result-card:hover {
            transform: translateY(-3px);
        }
        .result-card h3 { 
            color: var(--text-h) !important;
            font-size: 1.1rem; 
            margin-bottom: 15px; 
        }
        .result-amount { 
            font-size: 2rem; 
            font-weight: bold; 
            margin: 10px 0; 
        }

        /* Ø£Ù„ÙˆØ§Ù† Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .result-card.result-positive {
            background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(20,184,166,0.1)) !important;
            border-color: rgba(16,185,129,0.4) !important;
        }
        .result-card.result-positive .result-amount {
            color: var(--green-light) !important;
        }
        .result-card.result-warning {
            background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(251,191,36,0.1)) !important;
            border-color: rgba(245,158,11,0.4) !important;
        }
        .result-card.result-warning .result-amount {
            color: var(--gold-light) !important;
        }
        .result-card.result-negative {
            background: linear-gradient(135deg, rgba(239,68,68,0.2), rgba(248,113,113,0.1)) !important;
            border-color: rgba(239,68,68,0.4) !important;
        }
        .result-card.result-negative .result-amount {
            color: var(--red-light) !important;
        }

        .progress-bar { 
            background: var(--bg-input) !important; 
            height: 18px; 
            border-radius: var(--radius-xs) !important; 
            overflow: hidden; 
            margin: 15px 0; 
            border: 1px solid var(--border) !important;
        }
        .progress-fill { 
            background: linear-gradient(90deg, var(--green), var(--teal)) !important;
            height: 100%; 
            width: 0%; 
            transition: width 1s ease-out;
            box-shadow: var(--shadow-glow-g) !important;
        }
        #progressText {
            color: var(--text-body) !important;
            font-weight: 600;
        }

        /* ===== ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ© ===== */
        .sensitivity-analysis {
            background: var(--bg-card2) !important;
        }
        .sensitivity-analysis h3 {
            color: var(--text-h) !important;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        .slider-container {
            margin-bottom: 15px;
        }
        .slider-container label {
            color: var(--text-body) !important;
            font-weight: 600;
        }
        .slider-container input[type="range"] {
            width: 100%;
            margin: 15px 0;
            accent-color: var(--blue);
        }

        .tips-section { 
            background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(251,191,36,0.08)) !important;
            padding: 18px; 
            border-radius: var(--radius-xs) !important; 
            border-right: 4px solid var(--gold) !important;
            margin-top: 15px; 
            font-size: 0.95rem;
            color: var(--gold-light) !important;
        }

        /* ===== Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ ===== */
        .chart-container {
            background: var(--bg-card) !important;
        }
        .chart-container h2 {
            color: var(--text-h) !important;
        }
        .chart-wrapper { 
            height: 400px; 
            width: 100%; 
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .calculator-section { padding: 20px; }
            .results-grid { grid-template-columns: 1fr; }
            .chart-wrapper { height: 300px; }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">ğŸ“ˆ Ù…ÙÙƒØ±Ø© Ù…Ø³ØªØ«Ù…Ø±</a>
            <button class="navbar-toggle" onclick="toggleNavbar()">â˜°</button>
            <div class="navbar-menu" id="navbarMenu">
                <a href="index.html"                     class="navbar-item">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="advice.html"                    class="navbar-item calculator">ğŸ’° ØµØ§ÙÙŠ Ø§Ù„Ø«Ø±ÙˆØ©</a>
                <a href="salary_calculator.html"         class="navbar-item salary">ğŸ’¼ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø±Ø§ØªØ¨</a>
                <a href="zakat_purification.html"        class="navbar-item zakat">ğŸ•Œ Ø§Ù„Ø²ÙƒØ§Ø©</a>
                <a href="financial_freedom.html"         class="navbar-item fire active">ğŸ”¥ Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</a>
                <a href="investor_tips.html"             class="navbar-item tips">âš ï¸ Ù†ØµØ§Ø¦Ø­</a>
                <a href="snowball_calculator.html"       class="navbar-item calculator">â„ï¸ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ù…Ø±ÙƒØ¨</a>
                <a href="emergency_fund_calculator.html" class="navbar-item emergency">ğŸ›¡ï¸ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</a>
                <a href="average_calculator.html"        class="navbar-item average">ğŸ“Š Ù…ØªÙˆØ³Ø· Ø§Ù„Ø´Ø±Ø§Ø¡</a>
                <a href="company_valuation.html"         class="navbar-item company">ğŸ¢ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø´Ø±ÙƒØ©</a>
                <a href="retirement_calculator.html"     class="navbar-item retirement">ğŸ–ï¸ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯</a>
                <a href="portfolio_rating.html"          class="navbar-item portfolio">ğŸ›¡ï¸ Ø£Ù…Ø§Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©</a>
                <a href="stock_valuation.html"           class="navbar-item calculator">ğŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø³Ù‡Ù…</a>
                <a href="dca_calculator.html"            class="navbar-item calculator">ğŸ“… DCA</a>
                <a href="sell_decision.html"             class="navbar-item calculator">ğŸ¤” Ù‡Ù„ Ø£Ø¨ÙŠØ¹ØŸ</a>
                <a href="goal_calculator.html"           class="navbar-item calculator">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¹ÙƒØ³ÙŠ</a>
                <a href="allocation_calculator.html"     class="navbar-item allocation">âš–ï¸ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø­ÙØ¸Ø©</a>
            </div>
        </div>
    </nav>
    <script>
        function toggleNavbar(){document.getElementById('navbarMenu').classList.toggle('open');}
        document.addEventListener('DOMContentLoaded',function(){
            const page=(window.location.pathname.split('/').pop()||'index.html').split('?')[0]||'index.html';
            document.querySelectorAll('.navbar-item').forEach(function(el){
                el.classList.remove('active');
                if((el.getAttribute('href')||'').split('?')[0]===page)el.classList.add('active');
            });
        });
    </script>

    <div class="container">
        <div class="header">
            <h1>ğŸ”¥ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© (FIRE)</h1>
            <p>Ø®Ø·ØªÙƒ Ù„Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ± ÙˆØ§Ù„Ø¹ÙŠØ´ Ù…Ù† Ø¹ÙˆØ§Ø¦Ø¯ Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§ØªÙƒ</p>
        </div>

        <div class="calculator-section">
            <h2 class="section-title">ğŸ“Š Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ø®Ø·Ø©</h2>
            <div class="input-grid">
                <div class="input-group"><label>Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø´Ù‡Ø±ÙŠØ© (Ø±ÙŠØ§Ù„)</label><input type="number" id="monthlyExpenses" value="10000"></div>
                <div class="input-group"><label>ØµØ§ÙÙŠ Ø§Ù„Ø«Ø±ÙˆØ© Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø±ÙŠØ§Ù„)</label><input type="number" id="currentWealth" value="100000"></div>
                <div class="input-group"><label>Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (%)</label><input type="number" id="expectedReturn" value="8"></div>
                <div class="input-group"><label>Ø§Ù„Ø§Ø¯Ø®Ø§Ø± Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±ÙŠØ§Ù„)</label><input type="number" id="monthlySavings" value="3000"></div>
                <div class="input-group"><label>Ø§Ù„Ø¹Ù…Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ</label><input type="number" id="currentAge" value="30"></div>
                <div class="input-group"><label>ØªÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ø±</label><input type="number" id="lifeExpectancy" value="85"></div>
            </div>
            <br>
            <button class="calculate-btn" onclick="calculateFIRE()">Ø§Ø­Ø³Ø¨ Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</button>
        </div>

        <div id="resultsSection" class="results-section" style="display:none;">
            <h2 class="section-title">ğŸ“ˆ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</h2>
            <div class="results-grid">
                <div class="result-card" id="card-fire"><h3>ğŸ¯ Ù‡Ø¯Ù Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h3><div class="result-amount" id="fireNumber">-</div><p id="targetDetails">Ø±Ù‚Ù… Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</p></div>
                <div class="result-card" id="card-time"><h3>â³ Ø²Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„</h3><div class="result-amount" id="retirementAgeDisplay">-</div><p id="retirementDetails">-</p></div>
                <div class="result-card" id="card-progress"><h3>ğŸ“Š Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</h3><div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div><div id="progressText">0%</div></div>
                <div class="result-card" id="card-sustain"><h3>ğŸ›¡ï¸ Ø§Ø³ØªØ¯Ø§Ù…Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©</h3><div class="result-amount" id="longevityDisplay">-</div><p id="longevityDetails">-</p></div>
            </div>
            <div class="sensitivity-analysis">
                <h3>ğŸ›ï¸ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©</h3>
                <div class="slider-container">
                    <label>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø³Ù†ÙˆÙŠ: <span id="withdrawalRateValue">4%</span></label>
                    <input type="range" id="withdrawalRateSlider" min="3" max="7" step="0.5" value="4" oninput="updateWithdrawalRate(this.value)">
                </div>
                <div class="tips-section" id="riskWarning"></div>
            </div>
            <div class="chart-container">
                <h2 class="section-title">ğŸ“‰ Ù…Ø³Ø§Ø± Ù†Ù…Ùˆ Ø§Ù„Ø«Ø±ÙˆØ©</h2>
                <div class="chart-wrapper"><canvas id="fireChart"></canvas></div>
            </div>
        </div>
    </div>

    <script src="results-engine.js"></script>
    <script>
        let fireChart = null;
        function formatCurrency(amount){return new Intl.NumberFormat('ar-SA',{style:'currency',currency:'SAR',maximumFractionDigits:0}).format(amount);}

        function calculateFIRE(){
            const monthlyExpenses=parseFloat(document.getElementById('monthlyExpenses').value)||0;
            const currentWealth=parseFloat(document.getElementById('currentWealth').value)||0;
            const expectedReturn=parseFloat(document.getElementById('expectedReturn').value)||0;
            const monthlySavings=parseFloat(document.getElementById('monthlySavings').value)||0;
            const currentAge=parseInt(document.getElementById('currentAge').value)||0;
            const lifeExpectancy=parseInt(document.getElementById('lifeExpectancy').value)||85;
            const withdrawalRate=parseFloat(document.getElementById('withdrawalRateSlider').value)/100;
            const annualExpenses=monthlyExpenses*12;
            const fireTarget=annualExpenses/withdrawalRate;
            let years=0,wealth=currentWealth,wealthData=[currentWealth],labels=[0];
            while(wealth<fireTarget&&years<50){years++;wealth=wealth*(1+(expectedReturn/100))+(monthlySavings*12);wealthData.push(Math.round(wealth));labels.push(years);}

            document.getElementById('resultsSection').style.display='block';
            document.getElementById('fireNumber').textContent=formatCurrency(fireTarget);
            document.getElementById('retirementAgeDisplay').textContent=`${years+currentAge} Ø³Ù†Ø©`;
            document.getElementById('retirementDetails').textContent=`Ø³ØªØµÙ„ Ù„Ù„Ù‡Ø¯Ù Ø¨Ø¹Ø¯ ${years} Ø³Ù†Ø© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹`;

            const progress=Math.min((currentWealth/fireTarget)*100,100);
            document.getElementById('progressFill').style.width=progress+'%';
            document.getElementById('progressText').textContent=progress.toFixed(1)+'% Ù…Ø­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡Ø¯Ù';

            const retirementYearsNeeded=lifeExpectancy-(currentAge+years);
            document.getElementById('longevityDisplay').textContent=retirementYearsNeeded>0?`${retirementYearsNeeded} Ø³Ù†Ø©`:"Ù…Ø¤Ù…Ù†";
            document.getElementById('longevityDetails').textContent=`Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø³ØªØ­ØªØ§Ø¬ Ù„ØªØºØ·ÙŠØ© ${Math.max(0,retirementYearsNeeded)} Ø³Ù†Ø© ØªÙ‚Ø§Ø¹Ø¯`;

            const realReturn=expectedReturn-3;
            document.getElementById('riskWarning').innerHTML=realReturn<4?"âš ï¸ ØªÙ†Ø¨ÙŠÙ‡: Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ù†Ø®ÙØ¶. Ù‚Ø¯ ØªØ¶Ø·Ø± Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ø¯Ø®Ø§Ø± Ø£Ùˆ ØªØ£Ø¬ÙŠÙ„ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯.":"âœ… Ø®Ø·Ø© Ù…Ù…ØªØ§Ø²Ø©: Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„ØªØ¶Ø®Ù… Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†.";

            /* Ø£Ù„ÙˆØ§Ù† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
            const cardFire    = document.getElementById('card-fire');
            const cardTime    = document.getElementById('card-time');
            const cardProgress= document.getElementById('card-progress');
            const cardSustain = document.getElementById('card-sustain');

            cardFire.classList.remove('result-positive','result-negative','result-warning');
            cardTime.classList.remove('result-positive','result-negative','result-warning');
            cardProgress.classList.remove('result-positive','result-negative','result-warning');
            cardSustain.classList.remove('result-positive','result-negative','result-warning');

            /* Ù‡Ø¯Ù FIRE â€” Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ø­Ø§ÙŠØ¯ Ø²Ø§Ù‡ÙŠ */
            cardFire.classList.add(years <= 10 ? 'result-positive' : years <= 20 ? 'result-warning' : 'result-negative');
            cardTime.classList.add(years <= 15 ? 'result-positive' : years <= 25 ? 'result-warning' : 'result-negative');
            cardProgress.classList.add(progress >= 50 ? 'result-positive' : progress >= 25 ? 'result-warning' : 'result-negative');
            cardSustain.classList.add(retirementYearsNeeded > 10 ? 'result-positive' : retirementYearsNeeded > 0 ? 'result-warning' : 'result-negative');

            if(window.ResultsEngine) window.ResultsEngine.paint();

            updateChart(labels,wealthData,fireTarget);
            setTimeout(()=>{document.getElementById('resultsSection').scrollIntoView({behavior:'smooth'});},100);
        }

        function updateWithdrawalRate(val){document.getElementById('withdrawalRateValue').textContent=val+'%';calculateFIRE();}

        function updateChart(labels,data,target){
            const ctx=document.getElementById('fireChart').getContext('2d');
            if(fireChart)fireChart.destroy();
            fireChart=new Chart(ctx,{type:'line',data:{labels:labels.map(l=>'Ø³Ù†Ø© '+l),datasets:[{label:'Ù†Ù…Ùˆ Ø§Ù„Ø«Ø±ÙˆØ© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹',data:data,borderColor:'#10b981',backgroundColor:'rgba(16,185,129,0.15)',fill:true,tension:0.4,borderWidth:3,pointRadius:0,pointHoverRadius:6},{label:'Ø®Ø· Ù‡Ø¯Ù Ø§Ù„Ø­Ø±ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©',data:labels.map(()=>target),borderColor:'#f59e0b',borderDash:[6,4],pointRadius:0,fill:false,borderWidth:2}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{color:'#94a3b8',font:{size:12}}},tooltip:{mode:'index',intersect:false}},scales:{x:{ticks:{color:'#64748b'},grid:{color:'rgba(100,116,139,0.2)'}},y:{ticks:{color:'#64748b'},grid:{color:'rgba(100,116,139,0.2)'}}}},interaction:{mode:'index',intersect:false}}});
        }
    </script>
</body>
</html>
